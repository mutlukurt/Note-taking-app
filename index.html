<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>Not Alma Uygulaması</title>
    

    
    <link rel="stylesheet" href="style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body class="light-mode">
    <div class="container">
        <header class="header">
            <h1 class="app-title">
                <i class="fas fa-sticky-note"></i>
                Not Alma Uygulaması
            </h1>
        </header>
        
        <!-- Ayarlar bölümü -->
        <div class="settings-section">
            <div class="settings-container">
                <button class="settings-toggle" id="settingsToggle" title="Ayarlar">
                    <i class="fas fa-cog"></i>
                </button>
                <div class="settings-panel" id="settingsPanel">
                    <div class="settings-content">
                        <span class="settings-label">Ayarlar</span>
                        <div class="settings-buttons">
                            <button class="language-toggle" id="languageToggle" title="Dil Değiştir">
                                <i class="fas fa-globe"></i>
                                <span class="lang-text">TR</span>
                            </button>
                            <button class="theme-toggle" id="themeToggle" title="Tema Değiştir">
                                <i class="fas fa-sun"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="note-form">
            <div class="input-group">
                <input type="text" id="noteTitle" placeholder="Not başlığı..." class="note-input">
                
                <!-- Rich Text Editor Toolbar -->
                <div class="editor-toolbar">
                    <button type="button" class="toolbar-btn" data-command="bold" title="Kalın">
                        <i class="fas fa-bold"></i>
                    </button>
                    <button type="button" class="toolbar-btn" data-command="italic" title="İtalik">
                        <i class="fas fa-italic"></i>
                    </button>
                    <button type="button" class="toolbar-btn" data-command="underline" title="Altı Çizili">
                        <i class="fas fa-underline"></i>
                    </button>
                    <button type="button" class="toolbar-btn" data-command="strikeThrough" title="Üstü Çizili">
                        <i class="fas fa-strikethrough"></i>
                    </button>
                    <div class="toolbar-separator"></div>
                    <div class="color-picker-container">
                        <button type="button" class="toolbar-btn" id="textColorBtn" title="Metin Rengi">
                            <i class="fas fa-font"></i>
                            <span class="color-indicator"></span>
                        </button>
                        <div class="color-picker-wrapper">
                            <div class="spectrum-picker">
                                <div class="spectrum-gradient"></div>
                                <div class="spectrum-slider" id="spectrumSlider"></div>
                            </div>
                            <div class="color-grid">
                                <div class="color-swatch" data-color="#000000" style="background: #000000;"></div>
                                <div class="color-swatch" data-color="#ffffff" style="background: #ffffff;"></div>
                                <div class="color-swatch" data-color="#ff0000" style="background: #ff0000;"></div>
                                <div class="color-swatch" data-color="#00ff00" style="background: #00ff00;"></div>
                                <div class="color-swatch" data-color="#0000ff" style="background: #0000ff;"></div>
                                <div class="color-swatch" data-color="#ffff00" style="background: #ffff00;"></div>
                                <div class="color-swatch" data-color="#ff00ff" style="background: #ff00ff;"></div>
                                <div class="color-swatch" data-color="#00ffff" style="background: #00ffff;"></div>
                                <div class="color-swatch" data-color="#ff8000" style="background: #ff8000;"></div>
                                <div class="color-swatch" data-color="#8000ff" style="background: #8000ff;"></div>
                                <div class="color-swatch" data-color="#ff0080" style="background: #ff0080;"></div>
                                <div class="color-swatch" data-color="#80ff00" style="background: #80ff00;"></div>
                            </div>
                        </div>
                    </div>
                    <div class="toolbar-separator"></div>
                    <button type="button" class="toolbar-btn" data-command="insertUnorderedList" title="Liste">
                        <i class="fas fa-list-ul"></i>
                    </button>
                    <button type="button" class="toolbar-btn" data-command="insertOrderedList" title="Numaralı Liste">
                        <i class="fas fa-list-ol"></i>
                    </button>
                    <div class="toolbar-separator"></div>
                    <button type="button" class="toolbar-btn" data-command="justifyLeft" title="Sola Hizala">
                        <i class="fas fa-align-left"></i>
                    </button>
                    <button type="button" class="toolbar-btn" data-command="justifyCenter" title="Ortala">
                        <i class="fas fa-align-center"></i>
                    </button>
                    <button type="button" class="toolbar-btn" data-command="justifyRight" title="Sağa Hizala">
                        <i class="fas fa-align-right"></i>
                    </button>
                    <div class="toolbar-separator"></div>
                    <button type="button" class="toolbar-btn" id="addImageBtn" title="Fotoğraf Ekle">
                        <i class="fas fa-image"></i>
                    </button>
                    <input type="file" id="imageInput" accept="image/*" style="display: none;">
                </div>
                
                <div id="noteContent" class="note-textarea rich-editor" contenteditable="true" data-placeholder="Notunuzu buraya yazın..."></div>
            </div>
            <div class="button-group">
                <button id="addNote" class="btn btn-primary">
                    <i class="fas fa-plus"></i>
                    Not Ekle
                </button>
                <button id="clearForm" class="btn btn-secondary">
                    <i class="fas fa-eraser"></i>
                    Temizle
                </button>
                <button id="exportPDF" class="btn btn-export">
                    <i class="fas fa-file-pdf"></i>
                    PDF Aktar
                </button>
            </div>
        </div>

        <div class="search-section">
            <div class="search-box">
                <i class="fas fa-search"></i>
                <input type="text" id="searchInput" placeholder="Notlarınızda arayın..." class="search-input">
            </div>
        </div>

        <div class="notes-controls">
            <div class="sort-controls">
                <span style="color: var(--text-secondary); font-size: 0.9rem; margin-right: 10px;">Sırala:</span>
                <button class="sort-btn active" data-sort="date-desc">En Yeni</button>
                <button class="sort-btn" data-sort="date-asc">En Eski</button>
                <button class="sort-btn" data-sort="title">Başlık</button>
            </div>
            <div class="pin-controls">
                <button class="pin-filter active" data-filter="all">Tümü</button>
                <button class="pin-filter" data-filter="pinned">Sabitlenenler</button>
                <button class="pin-filter" data-filter="unpinned">Normal</button>
            </div>
        </div>

        <div class="notes-container" id="notesContainer">
            <!-- Notlar buraya dinamik olarak eklenecek -->
        </div>

        <div class="empty-state" id="emptyState">
            <i class="fas fa-notes-medical"></i>
            <h3>Henüz not eklenmemiş</h3>
            <p>İlk notunuzu ekleyerek başlayın!</p>
        </div>
    </div>

    <script>
        // Simple test functions
        function testTheme() {
            console.log('Test theme function called');
            const body = document.body;
            const icon = document.querySelector('#themeToggle i');
            
            if (body.classList.contains('dark-mode')) {
                body.classList.remove('dark-mode');
                icon.className = 'fas fa-sun';
                console.log('Light mode activated');
            } else {
                body.classList.add('dark-mode');
                icon.className = 'fas fa-moon';
                console.log('Dark mode activated');
            }
        }
        
        function testAddNote() {
            console.log('Test add note function called');
            const title = document.getElementById('noteTitle').value;
            const content = document.getElementById('noteContent').innerHTML;
            
            if (!title && !content) {
                alert('Lütfen en az bir başlık veya içerik girin!');
                return;
            }
            
            // Create note object
            const note = {
                id: Date.now(),
                title: title || 'Başlıksız Not',
                content: content || 'İçerik yok',
                date: new Date().toLocaleString('tr-TR'),
                timestamp: Date.now(),
                pinned: false
            };
            
            // Get notes from localStorage
            let notes = JSON.parse(localStorage.getItem('notes')) || [];
            notes.push(note);
            localStorage.setItem('notes', JSON.stringify(notes));
            
            // Clear form
            document.getElementById('noteTitle').value = '';
            document.getElementById('noteContent').innerHTML = '';
            
            // Show success message
            alert('Not başarıyla eklendi!');
            
            // Refresh notes display
            renderNotes();
        }
        
        function testClearForm() {
            console.log('Test clear form function called');
            document.getElementById('noteTitle').value = '';
            document.getElementById('noteContent').innerHTML = '';
            console.log('Form cleared');
        }
        
        // DOM loaded
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded, setting up test buttons...');
            
            // Set up test buttons
            const themeBtn = document.getElementById('themeToggle');
            if (themeBtn) {
                themeBtn.onclick = testTheme;
                console.log('Theme button set up');
            }
            
            const addBtn = document.getElementById('addNote');
            if (addBtn) {
                addBtn.onclick = testAddNote;
                console.log('Add note button set up');
            }
            
            const clearBtn = document.getElementById('clearForm');
            if (clearBtn) {
                clearBtn.onclick = testClearForm;
                console.log('Clear form button set up');
            }
            
            // Set up search input
            const searchInput = document.getElementById('searchInput');
            if (searchInput) {
                searchInput.oninput = (e) => {
                    searchNotes(e.target.value);
                };
                console.log('Search input set up');
            }
            
            // Set up PDF export button
            const exportBtn = document.getElementById('exportPDF');
            if (exportBtn) {
                exportBtn.onclick = exportToPDF;
                console.log('PDF export button set up');
            }
            
            // Set up rich text editor toolbar
            setupRichTextEditor();
            console.log('Rich text editor set up');
            
            // Set up language toggle
            setupLanguageToggle();
            console.log('Language toggle set up');
            
            // Set up settings toggle
            setupSettingsToggle();
            console.log('Settings toggle set up');
            
            console.log('Test buttons set up successfully!');
            
            // Load and display notes
            renderNotes();
        });
        
        // Function to render notes
        function renderNotes() {
            const notes = JSON.parse(localStorage.getItem('notes')) || [];
            const container = document.getElementById('notesContainer');
            const emptyState = document.getElementById('emptyState');
            
            if (notes.length === 0) {
                container.innerHTML = '';
                emptyState.style.display = 'flex';
                return;
            }
            
            emptyState.style.display = 'none';
            container.innerHTML = '';
            
            notes.forEach(note => {
                const noteCard = createNoteCard(note);
                container.appendChild(noteCard);
            });
        }
        
        // Function to create note card
        function createNoteCard(note) {
            const card = document.createElement('div');
            card.className = 'note-card';
            if (note.pinned) card.classList.add('pinned');
            
            card.innerHTML = `
                <div class="note-header">
                    <h3 class="note-title">${note.title}</h3>
                    <span class="note-date">${note.date}</span>
                </div>
                <div class="note-content">${note.content}</div>
                <div class="note-actions">
                    <button class="action-btn pin" onclick="togglePin(${note.id})" title="Sabitle">
                        <i class="fas fa-thumbtack"></i>
                    </button>
                    <button class="action-btn edit" onclick="editNote(${note.id})" title="Düzenle">
                        <i class="fas fa-edit"></i>
                    </button>
                    <button class="action-btn delete" onclick="deleteNote(${note.id})" title="Sil">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
                <div class="swipe-delete" data-note-id="${note.id}" onclick="deleteNoteWithUndo(${note.id})">
                    <i class="fas fa-trash"></i>
                    <span>Sil</span>
                </div>
            `;
            
            // Add swipe functionality after creating the card
            addSwipeFunctionality(card, note.id);
            
            return card;
        }
        
        // Function to delete note
        function deleteNote(id) {
            if (confirm('Bu notu silmek istediğinizden emin misiniz?')) {
                let notes = JSON.parse(localStorage.getItem('notes')) || [];
                notes = notes.filter(note => note.id !== id);
                localStorage.setItem('notes', JSON.stringify(notes));
                renderNotes();
                alert('Not silindi!');
            }
        }
        
        // Function to toggle pin
        function togglePin(id) {
            let notes = JSON.parse(localStorage.getItem('notes')) || [];
            const note = notes.find(note => note.id === id);
            if (note) {
                note.pinned = !note.pinned;
                localStorage.setItem('notes', JSON.stringify(notes));
                renderNotes();
            }
        }
        
        // Function to edit note
        function editNote(id) {
            let notes = JSON.parse(localStorage.getItem('notes')) || [];
            const note = notes.find(note => note.id === id);
            if (note) {
                document.getElementById('noteTitle').value = note.title;
                document.getElementById('noteContent').innerHTML = note.content;
                
                // Change add button to update button temporarily
                const addBtn = document.getElementById('addNote');
                addBtn.innerHTML = '<i class="fas fa-save"></i> Güncelle';
                addBtn.onclick = () => updateNote(id);
            }
        }
        
        // Function to update note
        function updateNote(id) {
            const title = document.getElementById('noteTitle').value;
            const content = document.getElementById('noteContent').innerHTML;
            
            if (!title && !content) {
                alert('Lütfen en az bir başlık veya içerik girin!');
                return;
            }
            
            let notes = JSON.parse(localStorage.getItem('notes')) || [];
            const noteIndex = notes.findIndex(note => note.id === id);
            
            if (noteIndex !== -1) {
                notes[noteIndex].title = title || 'Başlıksız Not';
                notes[noteIndex].content = content || 'İçerik yok';
                notes[noteIndex].date = new Date().toLocaleString('tr-TR');
                
                localStorage.setItem('notes', JSON.stringify(notes));
                
                // Reset form and button
                document.getElementById('noteTitle').value = '';
                document.getElementById('noteContent').innerHTML = '';
                
                const addBtn = document.getElementById('addNote');
                addBtn.innerHTML = '<i class="fas fa-plus"></i> Not Ekle';
                addBtn.onclick = testAddNote;
                
                renderNotes();
                alert('Not güncellendi!');
            }
        }
        
        // Function to search notes
        function searchNotes(query) {
            const notes = JSON.parse(localStorage.getItem('notes')) || [];
            const container = document.getElementById('notesContainer');
            const emptyState = document.getElementById('emptyState');
            
            if (!query.trim()) {
                renderNotes();
                return;
            }
            
            const filteredNotes = notes.filter(note => 
                note.title.toLowerCase().includes(query.toLowerCase()) ||
                note.content.toLowerCase().includes(query.toLowerCase())
            );
            
            if (filteredNotes.length === 0) {
                container.innerHTML = '';
                emptyState.innerHTML = `
                    <i class="fas fa-search"></i>
                    <h3>Arama sonucu bulunamadı</h3>
                    <p>"${query}" için sonuç yok</p>
                `;
                emptyState.style.display = 'flex';
                return;
            }
            
            emptyState.style.display = 'none';
            container.innerHTML = '';
            
            filteredNotes.forEach(note => {
                const noteCard = createNoteCard(note);
                container.appendChild(noteCard);
            });
        }
        
        // Swipe functionality
        function addSwipeFunctionality(card, noteId) {
            let startX = 0;
            let currentX = 0;
            let isDragging = false;
            let isSwiped = false;
            
            // Mouse events for desktop testing
            card.addEventListener('mousedown', (e) => {
                startX = e.clientX;
                isDragging = true;
                card.style.cursor = 'grabbing';
            });
            
            card.addEventListener('mousemove', (e) => {
                if (!isDragging) return;
                
                currentX = e.clientX;
                const diff = startX - currentX;
                
                if (diff > 0) {
                    card.style.transform = `translateX(-${Math.min(diff, 80)}px)`;
                }
            });
            
            card.addEventListener('mouseup', () => {
                if (!isDragging) return;
                
                const diff = startX - currentX;
                if (diff > 80) {
                    card.style.transform = 'translateX(-80px)';
                    isSwiped = true;
                } else {
                    card.style.transform = 'translateX(0)';
                    isSwiped = false;
                }
                
                isDragging = false;
                card.style.cursor = 'grab';
            });
            
            // Touch events for mobile
            card.addEventListener('touchstart', (e) => {
                startX = e.touches[0].clientX;
                isDragging = true;
            });
            
            card.addEventListener('touchmove', (e) => {
                if (!isDragging) return;
                
                currentX = e.touches[0].clientX;
                const diff = startX - currentX;
                
                if (diff > 0) {
                    e.preventDefault();
                    card.style.transform = `translateX(-${Math.min(diff, 80)}px)`;
                }
            });
            
            card.addEventListener('touchend', () => {
                if (!isDragging) return;
                
                const diff = startX - currentX;
                if (diff > 80) {
                    card.style.transform = 'translateX(-80px)';
                    isSwiped = true;
                } else {
                    card.style.transform = 'translateX(0)';
                    isSwiped = false;
                }
                
                isDragging = false;
            });
            
            // Click outside to reset
            document.addEventListener('click', (e) => {
                if (!card.contains(e.target) && isSwiped) {
                    card.style.transform = 'translateX(0)';
                    isSwiped = false;
                }
            });
            
            // Add click event to swipe delete button
            const swipeDeleteBtn = card.querySelector('.swipe-delete');
            if (swipeDeleteBtn) {
                swipeDeleteBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    deleteNoteWithUndo(noteId);
                    card.style.transform = 'translateX(0)';
                    isSwiped = false;
                });
            }
        }
        
        // Delete note with undo
        function deleteNoteWithUndo(id) {
            const noteId = parseInt(id);
            let notes = JSON.parse(localStorage.getItem('notes')) || [];
            const noteIndex = notes.findIndex(note => note.id === noteId);
            
            if (noteIndex === -1) return;
            
            const deletedNote = notes[noteIndex];
            notes.splice(noteIndex, 1);
            localStorage.setItem('notes', JSON.stringify(notes));
            
            // Show undo notification
            showUndoNotification(deletedNote, noteIndex);
            
            // Refresh display
            renderNotes();
        }
        
        // Show undo notification
        function showUndoNotification(note, originalIndex) {
            // Create notification element
            const notification = document.createElement('div');
            notification.className = 'undo-notification';
            notification.innerHTML = `
                <span>Not silindi</span>
                <button onclick="undoDelete(${note.id}, ${originalIndex})">Geri Al</button>
            `;
            
            document.body.appendChild(notification);
            
            // Auto remove after 4 seconds
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
            }, 4000);
        }
        
        // Undo delete
        function undoDelete(noteId, originalIndex) {
            let notes = JSON.parse(localStorage.getItem('notes')) || [];
            const deletedNote = notes.find(note => note.id === noteId);
            
            if (deletedNote) {
                notes.splice(originalIndex, 0, deletedNote);
                localStorage.setItem('notes', JSON.stringify(notes));
                renderNotes();
            }
            
            // Remove notification
            const notification = document.querySelector('.undo-notification');
            if (notification) {
                notification.parentNode.removeChild(notification);
            }
        }
        
        // PDF Export Function
        function exportToPDF() {
            const title = document.getElementById('noteTitle').value;
            const content = document.getElementById('noteContent').innerHTML;
            
            if (!title && !content) {
                alert('PDF oluşturmak için en az bir başlık veya içerik girin!');
                return;
            }
            
            // Create a temporary container for PDF content
            const pdfContainer = document.createElement('div');
            pdfContainer.style.cssText = `
                position: fixed;
                top: -9999px;
                left: -9999px;
                width: 800px;
                background: white;
                padding: 40px;
                font-family: Arial, sans-serif;
                color: #333;
                line-height: 1.6;
            `;
            
            pdfContainer.innerHTML = `
                <h1 style="color: #667eea; margin-bottom: 20px; font-size: 24px;">${title || 'Başlıksız Not'}</h1>
                <div style="margin-bottom: 20px; color: #666; font-size: 14px;">
                    Oluşturulma Tarihi: ${new Date().toLocaleString('tr-TR')}
                </div>
                <div style="font-size: 16px;">${content || 'İçerik yok'}</div>
            `;
            
            document.body.appendChild(pdfContainer);
            
            // Use html2canvas to capture the content
            html2canvas(pdfContainer, {
                scale: 2,
                useCORS: true,
                allowTaint: true,
                backgroundColor: '#ffffff'
            }).then(canvas => {
                // Remove the temporary container
                document.body.removeChild(pdfContainer);
                
                // Create PDF
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF('p', 'mm', 'a4');
                
                const imgData = canvas.toDataURL('image/png');
                const pdfWidth = pdf.internal.pageSize.getWidth();
                const pdfHeight = pdf.internal.pageSize.getHeight();
                const imgWidth = pdfWidth;
                const pageHeight = pdfHeight;
                const imgHeight = (canvas.height * imgWidth) / canvas.width;
                let heightLeft = imgHeight;
                let position = 0;
                
                pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                heightLeft -= pageHeight;
                
                while (heightLeft >= 0) {
                    position = heightLeft - imgHeight;
                    pdf.addPage();
                    pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                    heightLeft -= pageHeight;
                }
                
                // Download the PDF
                const fileName = `${title || 'not'}_${new Date().toISOString().slice(0, 10)}.pdf`;
                pdf.save(fileName);
                
                alert('PDF başarıyla indirildi!');
            }).catch(error => {
                console.error('PDF oluşturma hatası:', error);
                alert('PDF oluşturulurken bir hata oluştu. Lütfen tekrar deneyin.');
                document.body.removeChild(pdfContainer);
            });
        }
        
        // Rich Text Editor Setup
        function setupRichTextEditor() {
            const toolbar = document.querySelector('.editor-toolbar');
            const editor = document.getElementById('noteContent');
            const imageInput = document.getElementById('imageInput');
            
            console.log('Setting up rich text editor...');
            console.log('Toolbar found:', toolbar);
            console.log('Editor found:', editor);
            
            // Toolbar button clicks
            if (toolbar) {
                toolbar.addEventListener('click', (e) => {
                    const btn = e.target.closest('.toolbar-btn');
                    if (btn) {
                        const command = btn.dataset.command;
                        console.log('Button clicked:', command);
                        
                        if (command) {
                            e.preventDefault();
                            e.stopPropagation();
                            
                            // Focus editor first
                            editor.focus();
                            
                            // Execute command
                            const success = document.execCommand(command, false, null);
                            console.log('Command executed:', command, 'Success:', success);
                            
                            // Add visual feedback
                            btn.classList.add('active');
                            setTimeout(() => btn.classList.remove('active'), 200);
                        }
                    }
                });
            }
            
            // Image upload
            const addImageBtn = document.getElementById('addImageBtn');
            if (addImageBtn) {
                addImageBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('Image button clicked');
                    imageInput.click();
                });
            }
            
            if (imageInput) {
                imageInput.addEventListener('change', (e) => {
                    const file = e.target.files[0];
                    console.log('File selected:', file);
                    
                    if (file && file.type.startsWith('image/')) {
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            const img = document.createElement('img');
                            img.src = e.target.result;
                            img.style.maxWidth = '100%';
                            img.style.height = 'auto';
                            img.style.borderRadius = '10px';
                            img.style.margin = '10px 0';
                            
                            editor.focus();
                            const success = document.execCommand('insertHTML', false, img.outerHTML);
                            console.log('Image inserted:', success);
                            
                            // Clear the input
                            imageInput.value = '';
                        };
                        reader.readAsDataURL(file);
                    } else {
                        alert('Lütfen geçerli bir resim dosyası seçin!');
                    }
                });
            }
            
            // Color picker functionality
            const textColorBtn = document.getElementById('textColorBtn');
            
            // Text color picker
            if (textColorBtn) {
                console.log('Text color button found');
                const colorPickerWrapper = textColorBtn.parentElement.querySelector('.color-picker-wrapper');
                
                if (colorPickerWrapper) {
                    console.log('Color picker wrapper found');
                    const spectrumGradient = colorPickerWrapper.querySelector('.spectrum-gradient');
                    const spectrumSlider = colorPickerWrapper.querySelector('.spectrum-slider');
                    const colorSwatches = colorPickerWrapper.querySelectorAll('.color-swatch');
                    
                    console.log('Spectrum gradient:', spectrumGradient);
                    console.log('Spectrum slider:', spectrumSlider);
                    console.log('Color swatches:', colorSwatches.length);
                    
                    let currentColor = '#000000';
                    
                    textColorBtn.addEventListener('click', (e) => {
                        e.preventDefault();
                        e.stopPropagation();
                        console.log('Text color button clicked');
                        
                        // Toggle color picker wrapper visibility
                        const isVisible = colorPickerWrapper.classList.contains('active');
                        
                        // Hide all other color pickers first
                        document.querySelectorAll('.color-picker-wrapper').forEach(wrapper => {
                            wrapper.classList.remove('active');
                        });
                        
                        if (!isVisible) {
                            colorPickerWrapper.classList.add('active');
                        }
                    });
                    
                    // Spectrum gradient click handler
                    if (spectrumGradient && spectrumSlider) {
                        spectrumGradient.addEventListener('click', (e) => {
                            const rect = spectrumGradient.getBoundingClientRect();
                            const x = e.clientX - rect.left;
                            const percentage = Math.max(0, Math.min(1, x / rect.width));
                            
                            // Calculate color from percentage
                            const hue = percentage * 360;
                            
                            // Convert HSL to HEX for consistency
                            const hexColor = hslToHex(hue, 100, 50);
                            
                            // Update slider position
                            spectrumSlider.style.left = `${percentage * 100}%`;
                            
                            applyColor(hexColor);
                        });
                    }
                    
                    // Color swatch click handlers
                    if (colorSwatches.length > 0) {
                        colorSwatches.forEach(swatch => {
                            swatch.addEventListener('click', (e) => {
                                e.stopPropagation();
                                const color = swatch.dataset.color;
                                
                                // Remove selected class from all swatches
                                colorSwatches.forEach(s => s.classList.remove('selected'));
                                // Add selected class to clicked swatch
                                swatch.classList.add('selected');
                                
                                applyColor(color);
                            });
                        });
                    }
                    
                    // Apply color function
                    function applyColor(color) {
                        currentColor = color;
                        console.log('Text color selected:', color);
                        
                        editor.focus();
                        
                        // Apply color using simple execCommand
                        document.execCommand('foreColor', false, color);
                        
                        // Update color indicator
                        const colorIndicator = textColorBtn.querySelector('.color-indicator');
                        if (colorIndicator) {
                            colorIndicator.style.backgroundColor = color;
                        }
                        
                        editor.setAttribute('data-text-color', color);
                        
                        // Hide color picker
                        colorPickerWrapper.classList.remove('active');
                        
                        // Add visual feedback
                        textColorBtn.classList.add('active');
                        setTimeout(() => textColorBtn.classList.remove('active'), 200);
                    }
                    
                    // HSL to HEX conversion function
                    function hslToHex(h, s, l) {
                        l /= 100;
                        const a = s * Math.min(l, 1 - l) / 100;
                        const f = n => {
                            const k = (n + h / 30) % 12;
                            const color = l - a * Math.max(Math.min(k - 3, 9 - k, 1), -1);
                            return Math.round(255 * color).toString(16).padStart(2, '0');
                        };
                        return `#${f(0)}${f(8)}${f(4)}`;
                    }
                    
                    // Initialize color indicator
                    const colorIndicator = textColorBtn.querySelector('.color-indicator');
                    if (colorIndicator) {
                        colorIndicator.style.backgroundColor = '#000000';
                    }
                } else {
                    console.error('Color picker wrapper not found!');
                }
                
                // Hide color picker when clicking outside
                document.addEventListener('click', (e) => {
                    if (!e.target.closest('.color-picker-container')) {
                        document.querySelectorAll('.color-picker-wrapper').forEach(wrapper => {
                            wrapper.classList.remove('active');
                        });
                    }
                });
            }
            
            // Add keyboard shortcuts
            editor.addEventListener('keydown', (e) => {
                if (e.ctrlKey || e.metaKey) {
                    switch(e.key.toLowerCase()) {
                        case 'b':
                            e.preventDefault();
                            document.execCommand('bold', false, null);
                            break;
                        case 'i':
                            e.preventDefault();
                            document.execCommand('italic', false, null);
                            break;
                        case 'u':
                            e.preventDefault();
                            document.execCommand('underline', false, null);
                            break;
                    }
                }
            });
            
            console.log('Rich text editor setup complete!');
        }
        
        // Settings Toggle Setup
        function setupSettingsToggle() {
            const settingsBtn = document.getElementById('settingsToggle');
            const settingsPanel = document.getElementById('settingsPanel');
            let isSettingsOpen = false;
            
            console.log('Setting up settings toggle...');
            console.log('Settings button found:', settingsBtn);
            console.log('Settings panel found:', settingsPanel);
            
            if (settingsBtn && settingsPanel) {
                settingsBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    console.log('Settings button clicked!');
                    isSettingsOpen = !isSettingsOpen;
                    
                    if (isSettingsOpen) {
                        settingsBtn.classList.add('active');
                        settingsPanel.classList.add('active');
                        console.log('Settings panel opened');
                    } else {
                        settingsBtn.classList.remove('active');
                        settingsPanel.classList.remove('active');
                        console.log('Settings panel closed');
                    }
                });
                
                // Close settings panel when clicking outside
                document.addEventListener('click', (e) => {
                    if (!settingsBtn.contains(e.target) && !settingsPanel.contains(e.target)) {
                        if (isSettingsOpen) {
                            settingsBtn.classList.remove('active');
                            settingsPanel.classList.remove('active');
                            isSettingsOpen = false;
                            console.log('Settings panel closed (outside click)');
                        }
                    }
                });
            }
        }
        
        // Language Toggle Setup
        function setupLanguageToggle() {
            const languageBtn = document.getElementById('languageToggle');
            let currentLanguage = localStorage.getItem('language') || 'tr';
            
            console.log('Setting up language toggle...');
            console.log('Language button found:', languageBtn);
            console.log('Current language:', currentLanguage);
            
            // Set initial language
            updateLanguage(currentLanguage);
            
            if (languageBtn) {
                languageBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    console.log('Language button clicked!');
                    currentLanguage = currentLanguage === 'tr' ? 'en' : 'tr';
                    console.log('Switching to:', currentLanguage);
                    
                    localStorage.setItem('language', currentLanguage);
                    updateLanguage(currentLanguage);
                });
            }
        }
        
        // Update language function
        function updateLanguage(lang) {
            const languageBtn = document.getElementById('languageToggle');
            const langText = languageBtn.querySelector('.lang-text');
            
            console.log('Updating language to:', lang);
            
            if (lang === 'en') {
                languageBtn.classList.add('english');
                langText.textContent = 'EN';
                translateToEnglish();
                console.log('Switched to English');
            } else {
                languageBtn.classList.remove('english');
                langText.textContent = 'TR';
                translateToTurkish();
                console.log('Switched to Turkish');
            }
        }
        
        // Translation objects
        const translations = {
            tr: {
                appTitle: 'Not Alma Uygulaması',
                searchPlaceholder: 'Notlarda ara...',
                newNote: 'Yeni Not',
                deleteNote: 'Notu Sil',
                saveNote: 'Notu Kaydet',
                noteTitle: 'Not Başlığı',
                noteContent: 'Not içeriğini buraya yazın...',
                noNotes: 'Henüz not yok. İlk notunuzu oluşturun!',
                searchNoResults: 'Arama kriterlerine uygun not bulunamadı.',
                confirmDelete: 'Bu notu silmek istediğinizden emin misiniz?',
                exportNotes: 'Notları Dışa Aktar',
                importNotes: 'Notları İçe Aktar',
                darkMode: 'Karanlık Mod',
                lightMode: 'Aydınlık Mod',
                language: 'Dil',
                toolbarBold: 'Kalın',
                toolbarItalic: 'İtalik',
                toolbarUnderline: 'Altı Çizili',
                toolbarStrike: 'Üstü Çizili',
                toolbarImage: 'Resim Ekle',
                toolbarTextColor: 'Metin Rengi'
            },
            en: {
                appTitle: 'Note Taking App',
                searchPlaceholder: 'Search notes...',
                newNote: 'New Note',
                deleteNote: 'Delete Note',
                saveNote: 'Save Note',
                noteTitle: 'Note Title',
                noteContent: 'Write your note content here...',
                noNotes: 'No notes yet. Create your first note!',
                searchNoResults: 'No notes found matching your search criteria.',
                confirmDelete: 'Are you sure you want to delete this note?',
                exportNotes: 'Export Notes',
                importNotes: 'Import Notes',
                darkMode: 'Dark Mode',
                lightMode: 'Light Mode',
                language: 'Language',
                toolbarBold: 'Bold',
                toolbarItalic: 'Italic',
                toolbarUnderline: 'Underline',
                toolbarStrike: 'Strikethrough',
                toolbarImage: 'Add Image',
                toolbarTextColor: 'Text Color'
            }
        };
        
        // Translate to English
        function translateToEnglish() {
            const t = translations.en;
            
            // Update main elements
            document.querySelector('.app-title').innerHTML = `<i class="fas fa-sticky-note"></i> ${t.appTitle}`;
            document.querySelector('.settings-label').textContent = t.themeLabel;
            document.getElementById('noteTitle').placeholder = t.noteTitlePlaceholder;
            document.getElementById('noteContent').setAttribute('data-placeholder', t.noteContentPlaceholder);
            document.getElementById('addNote').innerHTML = `<i class="fas fa-plus"></i> ${t.addNote}`;
            document.getElementById('clearForm').innerHTML = `<i class="fas fa-eraser"></i> ${t.clearForm}`;
            document.getElementById('exportPDF').innerHTML = `<i class="fas fa-file-pdf"></i> ${t.exportPDF}`;
            document.getElementById('searchInput').placeholder = t.searchPlaceholder;
            
            // Update toolbar buttons
            document.querySelector('[data-command="bold"]').title = t.toolbarBold;
            document.querySelector('[data-command="italic"]').title = t.toolbarItalic;
            document.querySelector('[data-command="underline"]').title = t.toolbarUnderline;
            document.querySelector('[data-command="strikeThrough"]').title = t.toolbarStrike;
            document.querySelector('[data-command="insertUnorderedList"]').title = t.toolbarList;
            document.querySelector('[data-command="insertOrderedList"]').title = t.toolbarOrderedList;
            document.querySelector('[data-command="justifyLeft"]').title = t.toolbarLeft;
            document.querySelector('[data-command="justifyCenter"]').title = t.toolbarCenter;
            document.querySelector('[data-command="justifyRight"]').title = t.toolbarRight;
            document.getElementById('addImageBtn').title = t.toolbarImage;
            document.getElementById('textColorBtn').title = t.toolbarTextColor;
            
            // Update controls
            const sortSpan = document.querySelector('.sort-controls span');
            if (sortSpan) sortSpan.textContent = t.sortLabel;
            
            const newestBtn = document.querySelector('[data-sort="date-desc"]');
            if (newestBtn) newestBtn.textContent = t.newest;
            
            const oldestBtn = document.querySelector('[data-sort="date-asc"]');
            if (oldestBtn) oldestBtn.textContent = t.oldest;
            
            const titleBtn = document.querySelector('[data-sort="title"]');
            if (titleBtn) titleBtn.textContent = t.title;
            
            const allFilter = document.querySelector('[data-filter="all"]');
            if (allFilter) allFilter.textContent = t.all;
            
            const pinnedFilter = document.querySelector('[data-filter="pinned"]');
            if (pinnedFilter) pinnedFilter.textContent = t.pinned;
            
            const normalFilter = document.querySelector('[data-filter="unpinned"]');
            if (normalFilter) normalFilter.textContent = t.normal;
            
            // Update empty state
            const emptyState = document.getElementById('emptyState');
            emptyState.querySelector('h3').textContent = t.emptyStateTitle;
            emptyState.querySelector('p').textContent = t.emptyStateDesc;
            
            // Update privacy policy
            document.querySelector('.privacy-content h3').textContent = t.privacyTitle;
            document.querySelector('.privacy-text p:nth-child(1)').innerHTML = `<strong>${t.dataCollection}:</strong> ${t.dataCollectionText}`;
            document.querySelector('.privacy-text p:nth-child(2)').innerHTML = `<strong>${t.dataStorage}:</strong> ${t.dataStorageText}`;
            document.querySelector('.privacy-text p:nth-child(3)').innerHTML = `<strong>${t.cookies}:</strong> ${t.cookiesText}`;
            document.querySelector('.privacy-text p:nth-child(4)').innerHTML = `<strong>${t.thirdParty}:</strong> ${t.thirdPartyText}`;
            document.querySelector('.privacy-text p:nth-child(5)').innerHTML = `<strong>${t.security}:</strong> ${t.securityText}`;
            document.querySelector('.privacy-text p:nth-child(6)').innerHTML = `<strong>${t.contact}:</strong> ${t.contactText}`;
            document.querySelector('.privacy-links span').textContent = t.copyright;
        }
        
        // Translate to Turkish
        function translateToTurkish() {
            const t = translations.tr;
            
            // Update main elements
            document.querySelector('.app-title').innerHTML = `<i class="fas fa-sticky-note"></i> ${t.appTitle}`;
            document.querySelector('.settings-label').textContent = t.themeLabel;
            document.getElementById('noteTitle').placeholder = t.noteTitlePlaceholder;
            document.getElementById('noteContent').setAttribute('data-placeholder', t.noteContentPlaceholder);
            document.getElementById('addNote').innerHTML = `<i class="fas fa-plus"></i> ${t.addNote}`;
            document.getElementById('clearForm').innerHTML = `<i class="fas fa-eraser"></i> ${t.clearForm}`;
            document.getElementById('exportPDF').innerHTML = `<i class="fas fa-file-pdf"></i> ${t.exportPDF}`;
            document.getElementById('searchInput').placeholder = t.searchPlaceholder;
            
            // Update toolbar buttons
            document.querySelector('[data-command="bold"]').title = t.toolbarBold;
            document.querySelector('[data-command="italic"]').title = t.toolbarItalic;
            document.querySelector('[data-command="underline"]').title = t.toolbarUnderline;
            document.querySelector('[data-command="strikeThrough"]').title = t.toolbarStrike;
            document.querySelector('[data-command="insertUnorderedList"]').title = t.toolbarList;
            document.querySelector('[data-command="insertOrderedList"]').title = t.toolbarOrderedList;
            document.querySelector('[data-command="justifyLeft"]').title = t.toolbarLeft;
            document.querySelector('[data-command="justifyCenter"]').title = t.toolbarCenter;
            document.querySelector('[data-command="justifyRight"]').title = t.toolbarRight;
            document.getElementById('addImageBtn').title = t.toolbarImage;
            document.getElementById('textColorBtn').title = t.toolbarTextColor;
            
            // Update controls
            const sortSpan = document.querySelector('.sort-controls span');
            if (sortSpan) sortSpan.textContent = t.sortLabel;
            
            const newestBtn = document.querySelector('[data-sort="date-desc"]');
            if (newestBtn) newestBtn.textContent = t.newest;
            
            const oldestBtn = document.querySelector('[data-sort="date-asc"]');
            if (oldestBtn) oldestBtn.textContent = t.oldest;
            
            const titleBtn = document.querySelector('[data-sort="title"]');
            if (titleBtn) titleBtn.textContent = t.title;
            
            const allFilter = document.querySelector('[data-filter="all"]');
            if (allFilter) allFilter.textContent = t.all;
            
            const pinnedFilter = document.querySelector('[data-filter="pinned"]');
            if (pinnedFilter) pinnedFilter.textContent = t.pinned;
            
            const normalFilter = document.querySelector('[data-filter="unpinned"]');
            if (normalFilter) normalFilter.textContent = t.normal;
            
            // Update empty state
            const emptyState = document.getElementById('emptyState');
            emptyState.querySelector('h3').textContent = t.emptyStateTitle;
            emptyState.querySelector('p').textContent = t.emptyStateDesc;
            
            // Update privacy policy
            document.querySelector('.privacy-content h3').textContent = t.privacyTitle;
            document.querySelector('.privacy-text p:nth-child(1)').innerHTML = `<strong>${t.dataCollection}:</strong> ${t.dataCollectionText}`;
            document.querySelector('.privacy-text p:nth-child(2)').innerHTML = `<strong>${t.dataStorage}:</strong> ${t.dataStorageText}`;
            document.querySelector('.privacy-text p:nth-child(3)').innerHTML = `<strong>${t.cookies}:</strong> ${t.cookiesText}`;
            document.querySelector('.privacy-text p:nth-child(4)').innerHTML = `<strong>${t.thirdParty}:</strong> ${t.thirdPartyText}`;
            document.querySelector('.privacy-text p:nth-child(5)').innerHTML = `<strong>${t.security}:</strong> ${t.securityText}`;
            document.querySelector('.privacy-text p:nth-child(6)').innerHTML = `<strong>${t.contact}:</strong> ${t.contactText}`;
            document.querySelector('.privacy-links span').textContent = t.copyright;
        }
    </script>
    <script src="script.js"></script>
    
    <!-- Gizlilik Politikası -->
    <footer class="privacy-policy">
        <div class="container">
            <div class="privacy-content">
                <h3>🔒 Gizlilik Politikası</h3>
                <div class="privacy-text">
                    <p><strong>Veri Toplama:</strong> Bu uygulama hiçbir kişisel veri toplamaz. Tüm notlarınız sadece tarayıcınızda saklanır.</p>
                    <p><strong>Veri Saklama:</strong> Notlarınız LocalStorage kullanılarak yerel olarak saklanır. Hiçbir veri sunucuya gönderilmez.</p>
                    <p><strong>Çerezler:</strong> Uygulama sadece tema ve dil tercihlerinizi saklamak için gerekli çerezleri kullanır.</p>
                    <p><strong>Üçüncü Taraf:</strong> Font Awesome ikonları ve PDF kütüphaneleri için CDN kullanılır. Bu servisler sadece uygulama işlevselliği için gereklidir.</p>
                    <p><strong>Güvenlik:</strong> Tüm verileriniz tarayıcınızda güvenli şekilde saklanır ve şifrelenir.</p>
                    <p><strong>İletişim:</strong> Sorularınız için GitHub üzerinden iletişime geçebilirsiniz.</p>
                </div>
                <div class="privacy-links">
                    <span>© 2025 Not Alma Uygulaması | MIT License</span>
                </div>
            </div>
        </div>
    </footer>
</body>
</html>