<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>Not Alma Uygulaması</title>
    

    
    <link rel="stylesheet" href="style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body class="light-mode">
    <div class="container">
        <header class="header">
            <h1 class="app-title">
                <i class="fas fa-sticky-note"></i>
                Not Alma Uygulaması
            </h1>
        </header>
        
        <!-- Ayarlar bölümü -->
        <div class="settings-section">
            <div class="settings-container">
                <button class="settings-toggle" id="settingsToggle" title="Ayarlar" onclick="toggleSettings()">
                    <i class="fas fa-cog"></i>
                </button>
                <div class="settings-panel" id="settingsPanel">
                    <div class="settings-content">
                        <span class="settings-label">Ayarlar</span>
                        <div class="settings-buttons">
                            <button class="language-toggle" id="languageToggle" title="Dil Değiştir" onclick="toggleLanguage()">
                                <i class="fas fa-globe"></i>
                                <span class="lang-text">TR</span>
                            </button>
                            <button class="theme-toggle" id="themeToggle" title="Tema Değiştir">
                                <i class="fas fa-sun"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="note-form">
            <div class="input-group">
                <input type="text" id="noteTitle" placeholder="Not başlığı..." class="note-input">
                
                <!-- Rich Text Editor Toolbar -->
                <div class="editor-toolbar">
                    <button type="button" class="toolbar-btn" data-command="bold" title="Kalın">
                        <i class="fas fa-bold"></i>
                    </button>
                    <button type="button" class="toolbar-btn" data-command="italic" title="İtalik">
                        <i class="fas fa-italic"></i>
                    </button>
                    <button type="button" class="toolbar-btn" data-command="underline" title="Altı Çizili">
                        <i class="fas fa-underline"></i>
                    </button>
                    <button type="button" class="toolbar-btn" data-command="strikeThrough" title="Üstü Çizili">
                        <i class="fas fa-strikethrough"></i>
                    </button>
                    <div class="toolbar-separator"></div>
                    <!-- Header Selector -->
                    <div class="header-container">
                        <button type="button" class="toolbar-btn modern-btn" id="headerBtn" title="Başlık Formatı">
                            <i class="fas fa-heading"></i>
                            <span class="format-text">Normal</span>
                            <i class="fas fa-chevron-down dropdown-arrow"></i>
                        </button>
                        <div class="header-dropdown">
                            <button class="header-option" data-header="p" title="Normal Metin">
                                <div class="option-content">
                                    <span class="header-preview normal-preview">Aa</span>
                                    <div class="option-info">
                                        <span class="option-title">Normal</span>
                                        <span class="option-desc">Paragraf metni</span>
                                    </div>
                                </div>
                            </button>
                            <button class="header-option" data-header="h1" title="Büyük Başlık">
                                <div class="option-content">
                                    <span class="header-preview h1-preview">H1</span>
                                    <div class="option-info">
                                        <span class="option-title">Başlık 1</span>
                                        <span class="option-desc">Ana başlık</span>
                                    </div>
                                </div>
                            </button>
                            <button class="header-option" data-header="h2" title="Orta Başlık">
                                <div class="option-content">
                                    <span class="header-preview h2-preview">H2</span>
                                    <div class="option-info">
                                        <span class="option-title">Başlık 2</span>
                                        <span class="option-desc">Alt başlık</span>
                                    </div>
                                </div>
                            </button>
                            <button class="header-option" data-header="h3" title="Küçük Başlık">
                                <div class="option-content">
                                    <span class="header-preview h3-preview">H3</span>
                                    <div class="option-info">
                                        <span class="option-title">Başlık 3</span>
                                        <span class="option-desc">Küçük başlık</span>
                                    </div>
                                </div>
                            </button>
                        </div>
                    </div>
                    <div class="toolbar-separator"></div>
                    <button type="button" class="toolbar-btn" data-command="insertUnorderedList" title="Liste">
                        <i class="fas fa-list-ul"></i>
                    </button>
                    <button type="button" class="toolbar-btn" data-command="insertOrderedList" title="Numaralı Liste">
                        <i class="fas fa-list-ol"></i>
                    </button>
                    <div class="toolbar-separator"></div>
                    <button type="button" class="toolbar-btn" data-command="justifyLeft" title="Sola Hizala">
                        <i class="fas fa-align-left"></i>
                    </button>
                    <button type="button" class="toolbar-btn" data-command="justifyCenter" title="Ortala">
                        <i class="fas fa-align-center"></i>
                    </button>
                    <button type="button" class="toolbar-btn" data-command="justifyRight" title="Sağa Hizala">
                        <i class="fas fa-align-right"></i>
                    </button>
                    <div class="toolbar-separator"></div>
                    <button type="button" class="toolbar-btn" id="addImageBtn" title="Fotoğraf Ekle">
                        <i class="fas fa-image"></i>
                    </button>
                    <input type="file" id="imageInput" accept="image/*" style="display: none;">
                    <div class="toolbar-separator"></div>
                    <button type="button" class="toolbar-btn" id="colorGridBtn" title="Renk Paleti" onclick="openColorGrid()">
                        <i class="fas fa-palette"></i>
                    </button>
                </div>
                
                <div id="noteContent" class="note-textarea rich-editor" contenteditable="true" data-placeholder="Notunuzu buraya yazın..."></div>
            </div>
            <div class="button-group">
                <button id="addNote" class="btn btn-primary">
                    <i class="fas fa-plus"></i>
                    Not Ekle
                </button>
                <button id="clearForm" class="btn btn-secondary">
                    <i class="fas fa-eraser"></i>
                    Temizle
                </button>
                <button id="exportPDF" class="btn btn-export">
                    <i class="fas fa-file-pdf"></i>
                    PDF Aktar
                </button>
            </div>
        </div>

        <div class="search-section">
            <div class="search-box">
                <i class="fas fa-search"></i>
                <input type="text" id="searchInput" placeholder="Notlarınızda arayın..." class="search-input">
            </div>
        </div>

        <div class="notes-controls">
            <div class="sort-controls">
                <span style="color: var(--text-secondary); font-size: 0.9rem; margin-right: 10px;">Sırala:</span>
                <button class="sort-btn active" data-sort="date-desc">En Yeni</button>
                <button class="sort-btn" data-sort="date-asc">En Eski</button>
                <button class="sort-btn" data-sort="title">Başlık</button>
            </div>
            <div class="pin-controls">
                <button class="pin-filter active" data-filter="all">Tümü</button>
                <button class="pin-filter" data-filter="pinned">Sabitlenenler</button>
                <button class="pin-filter" data-filter="unpinned">Normal</button>
            </div>
        </div>

        <div class="notes-container" id="notesContainer">
            <!-- Notlar buraya dinamik olarak eklenecek -->
        </div>

        <div class="empty-state" id="emptyState">
            <i class="fas fa-notes-medical"></i>
            <h3>Henüz not eklenmemiş</h3>
            <p>İlk notunuzu ekleyerek başlayın!</p>
        </div>
    </div>

    <!-- Color Grid Modal -->
    <div id="colorGridModal" class="color-grid-modal">
        <div class="color-grid-content">
            <div class="color-grid-header">
                <h3>Renk Paleti</h3>
                <button class="close-color-grid" id="closeColorGrid">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="color-grid-container">
                <div class="color-grid">
                    <div class="grid-color" data-color="#000000" style="background-color: #000000;" title="Siyah" onclick="selectColor('#000000')"></div>
                    <div class="grid-color" data-color="#ff0000" style="background-color: #ff0000;" title="Kırmızı" onclick="selectColor('#ff0000')"></div>
                    <div class="grid-color" data-color="#ffffff" style="background-color: #ffffff; border: 1px solid #ccc;" title="Beyaz" onclick="selectColor('#ffffff')"></div>
                    <div class="grid-color" data-color="#00ff00" style="background-color: #00ff00;" title="Yeşil" onclick="selectColor('#00ff00')"></div>
                    <div class="grid-color" data-color="#0000ff" style="background-color: #0000ff;" title="Mavi" onclick="selectColor('#0000ff')"></div>
                    <div class="grid-color" data-color="#ffff00" style="background-color: #ffff00;" title="Sarı" onclick="selectColor('#ffff00')"></div>
                    <div class="grid-color" data-color="#ff00ff" style="background-color: #ff00ff;" title="Magenta" onclick="selectColor('#ff00ff')"></div>
                    <div class="grid-color" data-color="#00ffff" style="background-color: #00ffff;" title="Cyan" onclick="selectColor('#00ffff')"></div>
                    <div class="grid-color" data-color="#ffa500" style="background-color: #ffa500;" title="Turuncu" onclick="selectColor('#ffa500')"></div>
                    <div class="grid-color" data-color="#800080" style="background-color: #800080;" title="Mor" onclick="selectColor('#800080')"></div>
                    <div class="grid-color" data-color="#008000" style="background-color: #008000;" title="Koyu Yeşil" onclick="selectColor('#008000')"></div>
                    <div class="grid-color" data-color="#000080" style="background-color: #000080;" title="Lacivert" onclick="selectColor('#000080')"></div>
                    <div class="grid-color" data-color="#ff69b4" style="background-color: #ff69b4;" title="Pembe" onclick="selectColor('#ff69b4')"></div>
                    <div class="grid-color" data-color="#32cd32" style="background-color: #32cd32;" title="Açık Yeşil" onclick="selectColor('#32cd32')"></div>
                    <div class="grid-color" data-color="#87ceeb" style="background-color: #87ceeb;" title="Açık Mavi" onclick="selectColor('#87ceeb')"></div>
                    <div class="grid-color" data-color="#dda0dd" style="background-color: #dda0dd;" title="Açık Mor" onclick="selectColor('#dda0dd')"></div>
                    <div class="grid-color" data-color="#f0e68c" style="background-color: #f0e68c;" title="Açık Sarı" onclick="selectColor('#f0e68c')"></div>
                    <div class="grid-color" data-color="#ffb6c1" style="background-color: #ffb6c1;" title="Açık Pembe" onclick="selectColor('#ffb6c1')"></div>
                    <div class="grid-color" data-color="#ff4500" style="background-color: #ff4500;" title="Turuncu Kırmızı" onclick="selectColor('#ff4500')"></div>
                    <div class="grid-color" data-color="#4169e1" style="background-color: #4169e1;" title="Royal Mavi" onclick="selectColor('#4169e1')"></div>
                    <div class="grid-color" data-color="#228b22" style="background-color: #228b22;" title="Orman Yeşili" onclick="selectColor('#228b22')"></div>
                    <div class="grid-color" data-color="#daa520" style="background-color: #daa520;" title="Altın Sarısı" onclick="selectColor('#daa520')"></div>
                    <div class="grid-color" data-color="#c71585" style="background-color: #c71585;" title="Orta Pembe" onclick="selectColor('#c71585')"></div>
                    <div class="grid-color" data-color="#20b2aa" style="background-color: #20b2aa;" title="Açık Deniz Yeşili" onclick="selectColor('#20b2aa')"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Simple test functions
        function testTheme() {
            const body = document.body;
            const icon = document.querySelector('#themeToggle i');
            
            if (body.classList.contains('dark-mode')) {
                body.classList.remove('dark-mode');
                icon.className = 'fas fa-sun';
            } else {
                body.classList.add('dark-mode');
                icon.className = 'fas fa-moon';
            }
        }
        
        function testAddNote() {
            const title = document.getElementById('noteTitle').value;
            const content = document.getElementById('noteContent').innerHTML;
            
            if (!title && !content) {
                alert('Lütfen en az bir başlık veya içerik girin!');
                return;
            }
            
            // Create note object
            const note = {
                id: Date.now(),
                title: title || 'Başlıksız Not',
                content: content || 'İçerik yok',
                date: new Date().toLocaleString('tr-TR'),
                timestamp: Date.now(),
                pinned: false
            };
            
            // Get notes from localStorage
            let notes = JSON.parse(localStorage.getItem('notes')) || [];
            notes.push(note);
            localStorage.setItem('notes', JSON.stringify(notes));
            
            // Clear form
            document.getElementById('noteTitle').value = '';
            document.getElementById('noteContent').innerHTML = '';
            
            // Show success message
            alert('Not başarıyla eklendi!');
            
            // Refresh notes display
            renderNotes();
        }
        
        function testClearForm() {
            document.getElementById('noteTitle').value = '';
            document.getElementById('noteContent').innerHTML = '';
        }
        
        // Open color grid function
        function openColorGrid() {
            console.log('Opening color grid...');
            const colorGridModal = document.getElementById('colorGridModal');
            if (colorGridModal) {
                colorGridModal.classList.add('show');
                document.body.style.overflow = 'hidden';
                console.log('Color grid opened!');
            } else {
                console.error('Color grid modal not found!');
            }
        }
        
        // Global event listener for color grid button
        document.addEventListener('click', function(e) {
            if (e.target.closest('#colorGridBtn')) {
                console.log('Color grid button clicked via global listener');
                openColorGrid();
            }
        });
        
        // Global event listener for color selection
        document.addEventListener('click', function(e) {
            if (e.target.closest('.grid-color')) {
                const colorElement = e.target.closest('.grid-color');
                const color = colorElement.getAttribute('data-color');
                console.log('Color clicked via global listener:', color);
                selectColor(color);
            }
        });
        
        // Select color function
        function selectColor(color) {
            console.log('Color selected:', color);
            
            // Apply color to text
            applyTextColor(color);
            
            // Close modal after color selection
            const modal = document.getElementById('colorGridModal');
            if (modal) {
                modal.classList.remove('show');
                modal.style.display = 'none';
                document.body.style.overflow = '';
            }
            
            console.log('Color applied, modal closed');
            
            // Show notification
            showNotification(`Metin rengi değiştirildi: ${color}`, 'success');
        }
        
        // Color Grid Setup Function
        function setupColorGrid() {
            console.log('Setting up color grid...');
            const colorGridModal = document.getElementById('colorGridModal');
            const closeColorGrid = document.getElementById('closeColorGrid');
            const gridColors = document.querySelectorAll('.grid-color');
            
            console.log('Color grid elements:', {
                colorGridModal: !!colorGridModal,
                closeColorGrid: !!closeColorGrid,
                gridColorsCount: gridColors.length
            });
            
            if (!colorGridModal) {
                console.error('Color grid modal not found!');
                return;
            }

            // Close color grid modal
            const closeModal = () => {
                colorGridModal.classList.remove('show');
                document.body.style.overflow = ''; // Restore scrolling
            };

            closeColorGrid.addEventListener('click', closeModal);

            // Close modal when clicking outside
            colorGridModal.addEventListener('click', (e) => {
                if (e.target === colorGridModal) {
                    closeModal();
                }
            });

            // Close modal on escape key
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && colorGridModal.classList.contains('show')) {
                    closeModal();
                }
            });


        }
        
        // Apply text color function
        function applyTextColor(color) {
            const editor = document.getElementById('noteContent');
            
            if (!editor) {
                console.error('Editor not found!');
                return;
            }

            // Focus editor first
            editor.focus();
            
            // Check if there's a selection
            const selection = window.getSelection();
            
            if (selection.rangeCount > 0 && !selection.isCollapsed) {
                // Apply color to selected text
                document.execCommand('foreColor', false, color);
            } else {
                // No selection, apply color to cursor position
                document.execCommand('foreColor', false, color);
            }
        }
        
        // Show notification function
        function showNotification(message, type = 'info') {
            // Create notification element
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${type === 'success' ? '#4CAF50' : '#2196F3'};
                color: white;
                padding: 12px 20px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
                z-index: 10001;
                font-size: 14px;
                font-weight: 500;
                animation: slideInRight 0.3s ease;
            `;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            // Remove notification after 3 seconds
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }
        
        // DOM loaded
        document.addEventListener('DOMContentLoaded', function() {
            
            // Set up test buttons
            const themeBtn = document.getElementById('themeToggle');
            if (themeBtn) {
                themeBtn.onclick = testTheme;
            }
            
            const addBtn = document.getElementById('addNote');
            if (addBtn) {
                addBtn.onclick = testAddNote;
            }
            
            const clearBtn = document.getElementById('clearForm');
            if (clearBtn) {
                clearBtn.onclick = testClearForm;
            }
            
            // Set up search input
            const searchInput = document.getElementById('searchInput');
            if (searchInput) {
                searchInput.oninput = (e) => {
                    searchNotes(e.target.value);
                };
            }
            
            // Set up PDF export button
            const exportBtn = document.getElementById('exportPDF');
            if (exportBtn) {
                exportBtn.onclick = exportToPDF;
            }
            
            // Set up rich text editor toolbar
            setupRichTextEditor();
            
            // Set up language toggle
            setupLanguageToggle();
            
            // Set up settings toggle
            setupSettingsToggle();
            
            // Set up color grid
            setupColorGrid();
            
            // Load and display notes
            renderNotes();
        });
        
        // Function to render notes
        function renderNotes() {
            const notes = JSON.parse(localStorage.getItem('notes')) || [];
            const container = document.getElementById('notesContainer');
            const emptyState = document.getElementById('emptyState');
            
            if (notes.length === 0) {
                container.innerHTML = '';
                emptyState.style.display = 'flex';
                return;
            }
            
            emptyState.style.display = 'none';
            container.innerHTML = '';
            
            notes.forEach(note => {
                const noteCard = createNoteCard(note);
                container.appendChild(noteCard);
            });
        }
        
        // Function to create note card
        function createNoteCard(note) {
            const card = document.createElement('div');
            card.className = 'note-card';
            if (note.pinned) card.classList.add('pinned');
            
            card.innerHTML = `
                <div class="note-header">
                    <h3 class="note-title">${note.title}</h3>
                    <span class="note-date">${note.date}</span>
                </div>
                <div class="note-content">${note.content}</div>
                <div class="note-actions">
                    <button class="action-btn pin" onclick="togglePin(${note.id})" title="Sabitle">
                        <i class="fas fa-thumbtack"></i>
                    </button>
                    <button class="action-btn edit" onclick="editNote(${note.id})" title="Düzenle">
                        <i class="fas fa-edit"></i>
                    </button>
                    <button class="action-btn delete" onclick="deleteNote(${note.id})" title="Sil">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
                <div class="swipe-delete" data-note-id="${note.id}" onclick="deleteNoteWithUndo(${note.id})">
                    <i class="fas fa-trash"></i>
                    <span>Sil</span>
                </div>
            `;
            
            // Add swipe functionality after creating the card
            addSwipeFunctionality(card, note.id);
            
            return card;
        }
        
        // Function to delete note
        function deleteNote(id) {
            if (confirm('Bu notu silmek istediğinizden emin misiniz?')) {
                let notes = JSON.parse(localStorage.getItem('notes')) || [];
                notes = notes.filter(note => note.id !== id);
                localStorage.setItem('notes', JSON.stringify(notes));
                renderNotes();
                alert('Not silindi!');
            }
        }
        
        // Function to toggle pin
        function togglePin(id) {
            let notes = JSON.parse(localStorage.getItem('notes')) || [];
            const note = notes.find(note => note.id === id);
            if (note) {
                note.pinned = !note.pinned;
                localStorage.setItem('notes', JSON.stringify(notes));
                renderNotes();
            }
        }
        
        // Function to edit note
        function editNote(id) {
            let notes = JSON.parse(localStorage.getItem('notes')) || [];
            const note = notes.find(note => note.id === id);
            if (note) {
                document.getElementById('noteTitle').value = note.title;
                document.getElementById('noteContent').innerHTML = note.content;
                
                // Change add button to update button temporarily
                const addBtn = document.getElementById('addNote');
                addBtn.innerHTML = '<i class="fas fa-save"></i> Güncelle';
                addBtn.onclick = () => updateNote(id);
            }
        }
        
        // Function to update note
        function updateNote(id) {
            const title = document.getElementById('noteTitle').value;
            const content = document.getElementById('noteContent').innerHTML;
            
            if (!title && !content) {
                alert('Lütfen en az bir başlık veya içerik girin!');
                return;
            }
            
            let notes = JSON.parse(localStorage.getItem('notes')) || [];
            const noteIndex = notes.findIndex(note => note.id === id);
            
            if (noteIndex !== -1) {
                notes[noteIndex].title = title || 'Başlıksız Not';
                notes[noteIndex].content = content || 'İçerik yok';
                notes[noteIndex].date = new Date().toLocaleString('tr-TR');
                
                localStorage.setItem('notes', JSON.stringify(notes));
                
                // Reset form and button
                document.getElementById('noteTitle').value = '';
                document.getElementById('noteContent').innerHTML = '';
                
                const addBtn = document.getElementById('addNote');
                addBtn.innerHTML = '<i class="fas fa-plus"></i> Not Ekle';
                addBtn.onclick = testAddNote;
                
                renderNotes();
                alert('Not güncellendi!');
            }
        }
        
        // Function to search notes
        function searchNotes(query) {
            const notes = JSON.parse(localStorage.getItem('notes')) || [];
            const container = document.getElementById('notesContainer');
            const emptyState = document.getElementById('emptyState');
            
            if (!query.trim()) {
                renderNotes();
                return;
            }
            
            const filteredNotes = notes.filter(note => 
                note.title.toLowerCase().includes(query.toLowerCase()) ||
                note.content.toLowerCase().includes(query.toLowerCase())
            );
            
            if (filteredNotes.length === 0) {
                container.innerHTML = '';
                emptyState.innerHTML = `
                    <i class="fas fa-search"></i>
                    <h3>Arama sonucu bulunamadı</h3>
                    <p>"${query}" için sonuç yok</p>
                `;
                emptyState.style.display = 'flex';
                return;
            }
            
            emptyState.style.display = 'none';
            container.innerHTML = '';
            
            filteredNotes.forEach(note => {
                const noteCard = createNoteCard(note);
                container.appendChild(noteCard);
            });
        }
        
        // Swipe functionality
        function addSwipeFunctionality(card, noteId) {
            let startX = 0;
            let currentX = 0;
            let isDragging = false;
            let isSwiped = false;
            
            // Mouse events for desktop testing
            card.addEventListener('mousedown', (e) => {
                startX = e.clientX;
                isDragging = true;
                card.style.cursor = 'grabbing';
            });
            
            card.addEventListener('mousemove', (e) => {
                if (!isDragging) return;
                
                currentX = e.clientX;
                const diff = startX - currentX;
                
                if (diff > 0) {
                    card.style.transform = `translateX(-${Math.min(diff, 80)}px)`;
                }
            });
            
            card.addEventListener('mouseup', () => {
                if (!isDragging) return;
                
                const diff = startX - currentX;
                if (diff > 80) {
                    card.style.transform = 'translateX(-80px)';
                    isSwiped = true;
                } else {
                    card.style.transform = 'translateX(0)';
                    isSwiped = false;
                }
                
                isDragging = false;
                card.style.cursor = 'grab';
            });
            
            // Touch events for mobile
            card.addEventListener('touchstart', (e) => {
                startX = e.touches[0].clientX;
                isDragging = true;
            });
            
            card.addEventListener('touchmove', (e) => {
                if (!isDragging) return;
                
                currentX = e.touches[0].clientX;
                const diff = startX - currentX;
                
                if (diff > 0) {
                    e.preventDefault();
                    card.style.transform = `translateX(-${Math.min(diff, 80)}px)`;
                }
            });
            
            card.addEventListener('touchend', () => {
                if (!isDragging) return;
                
                const diff = startX - currentX;
                if (diff > 80) {
                    card.style.transform = 'translateX(-80px)';
                    isSwiped = true;
                } else {
                    card.style.transform = 'translateX(0)';
                    isSwiped = false;
                }
                
                isDragging = false;
            });
            
            // Click outside to reset
            document.addEventListener('click', (e) => {
                if (!card.contains(e.target) && isSwiped) {
                    card.style.transform = 'translateX(0)';
                    isSwiped = false;
                }
            });
            
            // Add click event to swipe delete button
            const swipeDeleteBtn = card.querySelector('.swipe-delete');
            if (swipeDeleteBtn) {
                swipeDeleteBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    deleteNoteWithUndo(noteId);
                    card.style.transform = 'translateX(0)';
                    isSwiped = false;
                });
            }
        }
        
        // Delete note with undo
        function deleteNoteWithUndo(id) {
            const noteId = parseInt(id);
            let notes = JSON.parse(localStorage.getItem('notes')) || [];
            const noteIndex = notes.findIndex(note => note.id === noteId);
            
            if (noteIndex === -1) return;
            
            const deletedNote = notes[noteIndex];
            notes.splice(noteIndex, 1);
            localStorage.setItem('notes', JSON.stringify(notes));
            
            // Show undo notification
            showUndoNotification(deletedNote, noteIndex);
            
            // Refresh display
            renderNotes();
        }
        
        // Show undo notification
        function showUndoNotification(note, originalIndex) {
            // Create notification element
            const notification = document.createElement('div');
            notification.className = 'undo-notification';
            notification.innerHTML = `
                <span>Not silindi</span>
                <button onclick="undoDelete(${note.id}, ${originalIndex})">Geri Al</button>
            `;
            
            document.body.appendChild(notification);
            
            // Auto remove after 4 seconds
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
            }, 4000);
        }
        
        // Undo delete
        function undoDelete(noteId, originalIndex) {
            let notes = JSON.parse(localStorage.getItem('notes')) || [];
            const deletedNote = notes.find(note => note.id === noteId);
            
            if (deletedNote) {
                notes.splice(originalIndex, 0, deletedNote);
                localStorage.setItem('notes', JSON.stringify(notes));
                renderNotes();
            }
            
            // Remove notification
            const notification = document.querySelector('.undo-notification');
            if (notification) {
                notification.parentNode.removeChild(notification);
            }
        }
        
        // PDF Export Function
        function exportToPDF() {
            const title = document.getElementById('noteTitle').value;
            const content = document.getElementById('noteContent').innerHTML;
            
            if (!title && !content) {
                alert('PDF oluşturmak için en az bir başlık veya içerik girin!');
                return;
            }
            
            // Create a temporary container for PDF content
            const pdfContainer = document.createElement('div');
            pdfContainer.style.cssText = `
                position: fixed;
                top: -9999px;
                left: -9999px;
                width: 800px;
                background: white;
                padding: 40px;
                font-family: Arial, sans-serif;
                color: #333;
                line-height: 1.6;
            `;
            
            pdfContainer.innerHTML = `
                <h1 style="color: #667eea; margin-bottom: 20px; font-size: 24px;">${title || 'Başlıksız Not'}</h1>
                <div style="margin-bottom: 20px; color: #666; font-size: 14px;">
                    Oluşturulma Tarihi: ${new Date().toLocaleString('tr-TR')}
                </div>
                <div style="font-size: 16px;">${content || 'İçerik yok'}</div>
            `;
            
            document.body.appendChild(pdfContainer);
            
            // Use html2canvas to capture the content
            html2canvas(pdfContainer, {
                scale: 2,
                useCORS: true,
                allowTaint: true,
                backgroundColor: '#ffffff'
            }).then(canvas => {
                // Remove the temporary container
                document.body.removeChild(pdfContainer);
                
                // Create PDF
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF('p', 'mm', 'a4');
                
                const imgData = canvas.toDataURL('image/png');
                const pdfWidth = pdf.internal.pageSize.getWidth();
                const pdfHeight = pdf.internal.pageSize.getHeight();
                const imgWidth = pdfWidth;
                const pageHeight = pdfHeight;
                const imgHeight = (canvas.height * imgWidth) / canvas.width;
                let heightLeft = imgHeight;
                let position = 0;
                
                pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                heightLeft -= pageHeight;
                
                while (heightLeft >= 0) {
                    position = heightLeft - imgHeight;
                    pdf.addPage();
                    pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                    heightLeft -= pageHeight;
                }
                
                // Download the PDF
                const fileName = `${title || 'not'}_${new Date().toISOString().slice(0, 10)}.pdf`;
                pdf.save(fileName);
                
                alert('PDF başarıyla indirildi!');
            }).catch(error => {
                console.error('PDF oluşturma hatası:', error);
                alert('PDF oluşturulurken bir hata oluştu. Lütfen tekrar deneyin.');
                document.body.removeChild(pdfContainer);
            });
        }
        
        // Rich Text Editor Setup
        function setupRichTextEditor() {
            const toolbar = document.querySelector('.editor-toolbar');
            const editor = document.getElementById('noteContent');
            const imageInput = document.getElementById('imageInput');
            
            // Toolbar button clicks
            if (toolbar) {
                toolbar.addEventListener('click', (e) => {
                    const btn = e.target.closest('.toolbar-btn');
                    if (btn) {
                        const command = btn.dataset.command;
                        
                        if (command) {
                            e.preventDefault();
                            e.stopPropagation();
                            
                            // Focus editor first
                            editor.focus();
                            
                            // Execute command
                            const success = document.execCommand(command, false, null);
                            
                            // Add visual feedback
                            btn.classList.add('active');
                            setTimeout(() => btn.classList.remove('active'), 200);
                        }
                    }
                });
            }
            
            // Image upload
            const addImageBtn = document.getElementById('addImageBtn');
            if (addImageBtn) {
                addImageBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    imageInput.click();
                });
            }
            
            if (imageInput) {
                imageInput.addEventListener('change', (e) => {
                    const file = e.target.files[0];
                    
                    if (file && file.type.startsWith('image/')) {
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            const img = document.createElement('img');
                            img.src = e.target.result;
                            img.style.maxWidth = '100%';
                            img.style.height = 'auto';
                            img.style.borderRadius = '10px';
                            img.style.margin = '10px 0';
                            
                            editor.focus();
                            const success = document.execCommand('insertHTML', false, img.outerHTML);
                            
                            // Clear the input
                            imageInput.value = '';
                        };
                        reader.readAsDataURL(file);
                    } else {
                        alert('Lütfen geçerli bir resim dosyası seçin!');
                    }
                });
            }
            
            // Color picker functionality
            const textColorBtn = document.getElementById('textColorBtn');
            
            // Text color picker
            if (textColorBtn) {
                const colorPalette = textColorBtn.parentElement.querySelector('.color-palette');
                const colorOptions = colorPalette.querySelectorAll('.color-option');
                
                let currentColor = '#000000';
                
                // Color button click handlers
                if (colorOptions.length > 0) {
                    colorOptions.forEach(btn => {
                        btn.addEventListener('click', (e) => {
                            e.stopPropagation();
                            const color = btn.dataset.color;
                            
                            // Remove selected class from all color buttons
                            colorOptions.forEach(s => s.classList.remove('selected'));
                            // Add selected class to clicked button
                            btn.classList.add('selected');
                            
                            applyColor(color);
                        });
                    });
                }
                
                // Apply color function
                function applyColor(color) {
                    currentColor = color;
                    
                    editor.focus();
                    
                    // Get current selection
                    const selection = window.getSelection();
                    
                    if (selection.rangeCount > 0 && !selection.isCollapsed) {
                        // Text is selected - apply color to selection
                        const range = selection.getRangeAt(0);
                        const selectedText = range.toString();
                        
                        if (selectedText.length > 0) {
                            // Create a span with the color
                            const span = document.createElement('span');
                            span.style.color = color;
                            span.textContent = selectedText;
                            
                            // Replace selected text with colored span
                            range.deleteContents();
                            range.insertNode(span);
                            
                            // Position cursor after the span
                            const newRange = document.createRange();
                            newRange.setStartAfter(span);
                            newRange.collapse(true);
                            selection.removeAllRanges();
                            selection.addRange(newRange);
                        }
                    } else {
                        // No selection - set color for future typing
                        document.execCommand('styleWithCSS', false, true);
                        document.execCommand('foreColor', false, color);
                    }
                    
                    // Update color indicator
                    const colorIndicator = textColorBtn.querySelector('.color-indicator');
                    if (colorIndicator) {
                        colorIndicator.style.backgroundColor = color;
                    }
                    
                    editor.setAttribute('data-text-color', color);
                    
                    // Add visual feedback
                    textColorBtn.classList.add('active');
                    setTimeout(() => textColorBtn.classList.remove('active'), 200);
                }
                
                // Initialize color indicator and select black by default
                const colorIndicator = textColorBtn.querySelector('.color-indicator');
                if (colorIndicator) {
                    colorIndicator.style.backgroundColor = '#000000';
                }
                
                // Select black button by default
                const blackBtn = colorPalette.querySelector('[data-color="#000000"]');
                if (blackBtn) {
                    blackBtn.classList.add('selected');
                }
            }
            
            // Header selector
            const headerBtn = toolbar.querySelector('#headerBtn');
            if (headerBtn) {
                const headerContainer = headerBtn.parentElement;
                const headerDropdown = headerContainer.querySelector('.header-dropdown');
                const headerOptions = headerDropdown.querySelectorAll('.header-option');
                const headerIndicator = headerBtn.querySelector('.format-text');
                
                let currentHeader = 'p';
                
                // Toggle dropdown
                headerBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    // Close other dropdowns first
                    document.querySelectorAll('.header-dropdown').forEach(dropdown => {
                        if (dropdown !== headerDropdown) {
                            dropdown.classList.remove('active');
                            dropdown.parentElement.classList.remove('active');
                        }
                    });
                    
                    // Toggle current dropdown
                    const isActive = headerDropdown.classList.contains('active');
                    headerDropdown.classList.toggle('active');
                    headerContainer.classList.toggle('active', !isActive);
                });
                
                // Header option click handlers
                headerOptions.forEach(option => {
                    option.addEventListener('click', (e) => {
                        e.preventDefault();
                        e.stopPropagation();
                        
                        const headerType = option.dataset.header;
                        applyHeader(headerType);
                        
                        // Update UI
                        headerOptions.forEach(opt => opt.classList.remove('selected'));
                        option.classList.add('selected');
                        
                        // Close dropdown
                        headerDropdown.classList.remove('active');
                        headerContainer.classList.remove('active');
                    });
                });
                
                // Apply header function
                function applyHeader(headerType) {
                    currentHeader = headerType;
                    editor.focus();
                    
                    // Get current selection or cursor position
                    const selection = window.getSelection();
                    
                    if (selection.rangeCount > 0) {
                        const range = selection.getRangeAt(0);
                        
                        // Find the current block element (paragraph or header)
                        let blockElement = range.commonAncestorContainer;
                        
                        // If we're in a text node, get its parent
                        if (blockElement.nodeType === Node.TEXT_NODE) {
                            blockElement = blockElement.parentElement;
                        }
                        
                        // Find the closest block-level element
                        while (blockElement && blockElement !== editor && 
                               !['P', 'H1', 'H2', 'H3', 'DIV'].includes(blockElement.tagName)) {
                            blockElement = blockElement.parentElement;
                        }
                        
                        // If we found a valid block element
                        if (blockElement && blockElement !== editor) {
                            const content = blockElement.innerHTML;
                            const newElement = document.createElement(headerType.toUpperCase());
                            newElement.innerHTML = content;
                            
                            // Copy any existing styles
                            if (blockElement.style.cssText) {
                                newElement.style.cssText = blockElement.style.cssText;
                            }
                            
                            // Replace the old element
                            blockElement.parentNode.replaceChild(newElement, blockElement);
                            
                            // Restore cursor position
                            const newRange = document.createRange();
                            newRange.selectNodeContents(newElement);
                            newRange.collapse(false);
                            selection.removeAllRanges();
                            selection.addRange(newRange);
                        } else {
                            // If no block element found, use execCommand for new content
                            if (headerType === 'p') {
                                document.execCommand('formatBlock', false, 'div');
                            } else {
                                document.execCommand('formatBlock', false, headerType);
                            }
                        }
                    }
                    
                    // Update indicator
                    if (headerIndicator) {
                        const headerNames = {
                            'p': 'Normal',
                            'h1': 'Başlık 1',
                            'h2': 'Başlık 2', 
                            'h3': 'Başlık 3'
                        };
                        headerIndicator.textContent = headerNames[headerType] || 'Normal';
                    }
                    
                    // Add visual feedback
                    headerBtn.classList.add('active');
                    setTimeout(() => headerBtn.classList.remove('active'), 200);
                }
                
                // Initialize - select normal text by default
                const normalOption = headerDropdown.querySelector('[data-header="p"]');
                if (normalOption) {
                    normalOption.classList.add('selected');
                }
                
                // Close dropdown when clicking outside
                document.addEventListener('click', (e) => {
                    if (!e.target.closest('.header-container')) {
                        headerDropdown.classList.remove('active');
                        headerContainer.classList.remove('active');
                    }
                });
            }
            
            // Add keyboard shortcuts
            editor.addEventListener('keydown', (e) => {
                if (e.ctrlKey || e.metaKey) {
                    switch(e.key.toLowerCase()) {
                        case 'b':
                            e.preventDefault();
                            document.execCommand('bold', false, null);
                            break;
                        case 'i':
                            e.preventDefault();
                            document.execCommand('italic', false, null);
                            break;
                        case 'u':
                            e.preventDefault();
                            document.execCommand('underline', false, null);
                            break;
                    }
                }
            });
        }
        
        // Settings Toggle Setup
        function setupSettingsToggle() {
            const settingsBtn = document.getElementById('settingsToggle');
            const settingsPanel = document.getElementById('settingsPanel');
            let isSettingsOpen = false;
            
            if (settingsBtn && settingsPanel) {
                settingsBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    isSettingsOpen = !isSettingsOpen;
                    
                    if (isSettingsOpen) {
                        settingsBtn.classList.add('active');
                        settingsPanel.classList.add('active');
                    } else {
                        settingsBtn.classList.remove('active');
                        settingsPanel.classList.remove('active');
                    }
                });
                
                // Close settings panel when clicking outside
                document.addEventListener('click', (e) => {
                    if (!settingsBtn.contains(e.target) && !settingsPanel.contains(e.target)) {
                        if (isSettingsOpen) {
                            settingsBtn.classList.remove('active');
                            settingsPanel.classList.remove('active');
                            isSettingsOpen = false;
                        }
                    }
                });
            }
        }
        
        // Language Toggle Setup
        function setupLanguageToggle() {
            const languageBtn = document.getElementById('languageToggle');
            let currentLanguage = localStorage.getItem('language') || 'tr';
            
            // Set initial language
            updateLanguage(currentLanguage);
            
            if (languageBtn) {
                languageBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    currentLanguage = currentLanguage === 'tr' ? 'en' : 'tr';
                    
                    localStorage.setItem('language', currentLanguage);
                    updateLanguage(currentLanguage);
                });
            }
        }
        
        // Update language function
        function updateLanguage(lang) {
            const t = translations[lang];
            
            // Update language button
            const languageBtn = document.getElementById('languageToggle');
            const langText = languageBtn.querySelector('.lang-text');
            
            if (lang === 'en') {
                languageBtn.classList.add('english');
                langText.textContent = 'EN';
            } else {
                languageBtn.classList.remove('english');
                langText.textContent = 'TR';
            }
            
            // Update main elements
            document.querySelector('.app-title').innerHTML = `<i class="fas fa-sticky-note"></i> ${t.appTitle}`;
            document.querySelector('.settings-label').textContent = t.themeLabel;
            document.getElementById('noteTitle').placeholder = t.noteTitlePlaceholder;
            document.getElementById('noteContent').setAttribute('data-placeholder', t.noteContentPlaceholder);
            document.getElementById('addNote').innerHTML = `<i class="fas fa-plus"></i> ${t.addNote}`;
            document.getElementById('clearForm').innerHTML = `<i class="fas fa-eraser"></i> ${t.clearForm}`;
            document.getElementById('exportPDF').innerHTML = `<i class="fas fa-file-pdf"></i> ${t.exportPDF}`;
            document.getElementById('searchInput').placeholder = t.searchPlaceholder;
            
            // Update toolbar buttons
            document.querySelector('[data-command="bold"]').title = t.toolbarBold;
            document.querySelector('[data-command="italic"]').title = t.toolbarItalic;
            document.querySelector('[data-command="underline"]').title = t.toolbarUnderline;
            document.querySelector('[data-command="strikeThrough"]').title = t.toolbarStrike;
            document.querySelector('[data-command="insertUnorderedList"]').title = t.toolbarList;
            document.querySelector('[data-command="insertOrderedList"]').title = t.toolbarOrderedList;
            document.querySelector('[data-command="justifyLeft"]').title = t.toolbarLeft;
            document.querySelector('[data-command="justifyCenter"]').title = t.toolbarCenter;
            document.querySelector('[data-command="justifyRight"]').title = t.toolbarRight;
            document.getElementById('addImageBtn').title = t.toolbarImage;
            document.getElementById('textColorBtn').title = t.toolbarTextColor;
            
            // Update controls
            const sortSpan = document.querySelector('.sort-controls span');
            if (sortSpan) sortSpan.textContent = t.sortLabel;
            
            const newestBtn = document.querySelector('[data-sort="date-desc"]');
            if (newestBtn) newestBtn.textContent = t.newest;
            
            const oldestBtn = document.querySelector('[data-sort="date-asc"]');
            if (oldestBtn) oldestBtn.textContent = t.oldest;
            
            const titleBtn = document.querySelector('[data-sort="title"]');
            if (titleBtn) titleBtn.textContent = t.title;
            
            const allFilter = document.querySelector('[data-filter="all"]');
            if (allFilter) allFilter.textContent = t.allNotes;
            
            const pinnedFilter = document.querySelector('[data-filter="pinned"]');
            if (pinnedFilter) pinnedFilter.textContent = t.pinnedNotes;
            
            const normalFilter = document.querySelector('[data-filter="unpinned"]');
            if (normalFilter) normalFilter.textContent = t.normalNotes;
            
            // Update empty state
            const emptyState = document.getElementById('emptyState');
            emptyState.querySelector('h3').textContent = t.emptyStateTitle;
            emptyState.querySelector('p').textContent = t.emptyStateDesc;
            
            // Update privacy policy
            document.querySelector('#privacyTitle').textContent = t.privacyTitle;
            document.querySelector('#dataCollectionLabel').textContent = t.dataCollection + ':';
            document.querySelector('#dataCollectionText').textContent = t.dataCollectionText;
            document.querySelector('#dataStorageLabel').textContent = t.dataStorage + ':';
            document.querySelector('#dataStorageText').textContent = t.dataStorageText;
            document.querySelector('#cookiesLabel').textContent = t.cookies + ':';
            document.querySelector('#cookiesText').textContent = t.cookiesText;
            document.querySelector('#thirdPartyLabel').textContent = t.thirdParty + ':';
            document.querySelector('#thirdPartyText').textContent = t.thirdPartyText;
            document.querySelector('#securityLabel').textContent = t.security + ':';
            document.querySelector('#securityText').textContent = t.securityText;
            document.querySelector('#contactLabel').textContent = t.contact + ':';
            document.querySelector('#contactText').textContent = t.contactText;
            document.querySelector('#copyrightText').textContent = t.copyright;
            
            // Update MIT License
            const mitLicenseElement = document.querySelector('#mitLicenseText');
            mitLicenseElement.innerHTML = `<strong>${t.mitLicense}</strong> ${t.mitLicenseText} <a href="https://github.com/mutlukurt/Note-taking-app" target="_blank" rel="noopener">${t.githubRepo}</a>${t.visitText}`;
        }
        
        // Translation objects
        const translations = {
            tr: {
                appTitle: 'Not Alma Uygulaması',
                searchPlaceholder: 'Notlarda ara...',
                newNote: 'Yeni Not',
                deleteNote: 'Notu Sil',
                saveNote: 'Notu Kaydet',
                noteTitle: 'Not Başlığı',
                noteContent: 'Not içeriğini buraya yazın...',
                noNotes: 'Henüz not yok. İlk notunuzu oluşturun!',
                searchNoResults: 'Arama kriterlerine uygun not bulunamadı.',
                confirmDelete: 'Bu notu silmek istediğinizden emin misiniz?',
                exportNotes: 'Notları Dışa Aktar',
                importNotes: 'Notları İçe Aktar',
                darkMode: 'Karanlık Mod',
                lightMode: 'Aydınlık Mod',
                language: 'Dil',
                toolbarBold: 'Kalın',
                toolbarItalic: 'İtalik',
                toolbarUnderline: 'Altı Çizili',
                toolbarStrike: 'Üstü Çizili',
                toolbarImage: 'Resim Ekle',
                toolbarTextColor: 'Metin Rengi',
                title: "Not Alma Uygulaması",
                noteTitlePlaceholder: "Not Başlığı",
                noteContentPlaceholder: "Not İçeriği",
                addNote: "Not Ekle",
                clearForm: "Temizle",
                exportPDF: "PDF Aktar",
                sortLabel: "Sırala:",
                newest: "En Yeni",
                oldest: "En Eski",
                title: "Not Alma Uygulaması",
                noteTitle: "Not Başlığı",
                noteContent: "Not İçeriği",
                addNote: "Not Ekle",
                clear: "Temizle",
                search: "Notlarda ara...",
                allNotes: "Tüm Notlar",
                pinnedNotes: "Sabitlenenler",
                normalNotes: "Normal Notlar",
                newest: "En Yeni",
                oldest: "En Eski",
                byTitle: "Başlık",
                edit: "Düzenle",
                delete: "Sil",
                pin: "Sabitle",
                unpin: "Sabitlemeyi Kaldır",
                save: "Kaydet",
                cancel: "İptal",
                undo: "Geri Al",
                emptyStateTitle: "Henüz not eklenmemiş",
                emptyStateDesc: "İlk notunuzu ekleyerek başlayın!",
                
                // Privacy Policy Translations
                privacyTitle: "🔒 Gizlilik Politikası",
                dataCollection: "Veri Toplama",
                dataCollectionText: "Bu uygulama hiçbir kişisel veri toplamaz. Tüm notlarınız sadece tarayıcınızda saklanır.",
                dataStorage: "Veri Saklama",
                dataStorageText: "Notlarınız LocalStorage kullanılarak yerel olarak saklanır. Hiçbir veri sunucuya gönderilmez.",
                cookies: "Çerezler",
                cookiesText: "Uygulama sadece tema ve dil tercihlerinizi saklamak için gerekli çerezleri kullanır.",
                thirdParty: "Üçüncü Taraf",
                thirdPartyText: "Font Awesome ikonları ve PDF kütüphaneleri için CDN kullanılır. Bu servisler sadece uygulama işlevselliği için gereklidir.",
                security: "Güvenlik",
                securityText: "Tüm verileriniz tarayıcınızda güvenli şekilde saklanır ve şifrelenir.",
                contact: "İletişim",
                contactText: "Sorularınız için GitHub üzerinden iletişime geçebilirsiniz.",
                copyright: "© 2025 Not Alma Uygulaması | MIT License",
                mitLicense: "MIT Lisansı:",
                mitLicenseText: "Bu proje açık kaynak kodludur. Kaynak kodu serbestçe kullanabilir, değiştirebilir ve dağıtabilirsiniz. Detaylar için",
                githubRepo: "GitHub deposunu",
                visitText: "ziyaret edin."
            },
            en: {
                appTitle: 'Note Taking App',
                searchPlaceholder: 'Search notes...',
                newNote: 'New Note',
                deleteNote: 'Delete Note',
                saveNote: 'Save Note',
                noteTitle: 'Note Title',
                noteContent: 'Write your note content here...',
                noNotes: 'No notes yet. Create your first note!',
                searchNoResults: 'No notes found matching your search criteria.',
                confirmDelete: 'Are you sure you want to delete this note?',
                exportNotes: 'Export Notes',
                importNotes: 'Import Notes',
                darkMode: 'Dark Mode',
                lightMode: 'Light Mode',
                language: 'Language',
                toolbarBold: 'Bold',
                toolbarItalic: 'Italic',
                toolbarUnderline: 'Underline',
                toolbarStrike: 'Strikethrough',
                toolbarImage: 'Add Image',
                toolbarTextColor: 'Text Color',
                title: "Note Taking App",
                noteTitlePlaceholder: "Note Title",
                noteContentPlaceholder: "Note Content",
                addNote: "Add Note",
                clear: "Clear",
                exportPDF: "Export PDF",
                sortLabel: "Sort:",
                newest: "Newest",
                oldest: "Oldest",
                byTitle: "Title",
                edit: "Edit",
                delete: "Delete",
                pin: "Pin",
                unpin: "Unpin",
                save: "Save",
                cancel: "Cancel",
                undo: "Undo",
                emptyStateTitle: "No notes yet",
                emptyStateDesc: "Start by adding your first note!",
                
                // Privacy Policy Translations
                privacyTitle: "🔒 Privacy Policy",
                dataCollection: "Data Collection",
                dataCollectionText: "This application does not collect any personal data. All your notes are stored only in your browser.",
                dataStorage: "Data Storage",
                dataStorageText: "Your notes are stored locally using LocalStorage. No data is sent to any server.",
                cookies: "Cookies",
                cookiesText: "The application only uses necessary cookies to store your theme and language preferences.",
                thirdParty: "Third Party",
                thirdPartyText: "CDN is used for Font Awesome icons and PDF libraries. These services are only required for application functionality.",
                security: "Security",
                securityText: "All your data is stored securely and encrypted in your browser.",
                contact: "Contact",
                contactText: "For questions, you can contact us via GitHub.",
                copyright: "© 2025 Note Taking App | MIT License",
                mitLicense: "MIT License:",
                mitLicenseText: "This project is open source. You are free to use, modify, and distribute it. For details, visit",
                githubRepo: "GitHub repository",
                visitText: "."
            }
        };
        
        // Translate to English
        function translateToEnglish() {
            const t = translations.en;
            
            // Update main elements
            document.querySelector('.app-title').innerHTML = `<i class="fas fa-sticky-note"></i> ${t.appTitle}`;
            document.querySelector('.settings-label').textContent = t.themeLabel;
            document.getElementById('noteTitle').placeholder = t.noteTitlePlaceholder;
            document.getElementById('noteContent').setAttribute('data-placeholder', t.noteContentPlaceholder);
            document.getElementById('addNote').innerHTML = `<i class="fas fa-plus"></i> ${t.addNote}`;
            document.getElementById('clearForm').innerHTML = `<i class="fas fa-eraser"></i> ${t.clearForm}`;
            document.getElementById('exportPDF').innerHTML = `<i class="fas fa-file-pdf"></i> ${t.exportPDF}`;
            document.getElementById('searchInput').placeholder = t.searchPlaceholder;
            
            // Update toolbar buttons
            document.querySelector('[data-command="bold"]').title = t.toolbarBold;
            document.querySelector('[data-command="italic"]').title = t.toolbarItalic;
            document.querySelector('[data-command="underline"]').title = t.toolbarUnderline;
            document.querySelector('[data-command="strikeThrough"]').title = t.toolbarStrike;
            document.querySelector('[data-command="insertUnorderedList"]').title = t.toolbarList;
            document.querySelector('[data-command="insertOrderedList"]').title = t.toolbarOrderedList;
            document.querySelector('[data-command="justifyLeft"]').title = t.toolbarLeft;
            document.querySelector('[data-command="justifyCenter"]').title = t.toolbarCenter;
            document.querySelector('[data-command="justifyRight"]').title = t.toolbarRight;
            document.getElementById('addImageBtn').title = t.toolbarImage;
            document.getElementById('textColorBtn').title = t.toolbarTextColor;
            
            // Update controls
            const sortSpan = document.querySelector('.sort-controls span');
            if (sortSpan) sortSpan.textContent = t.sortLabel;
            
            const newestBtn = document.querySelector('[data-sort="date-desc"]');
            if (newestBtn) newestBtn.textContent = t.newest;
            
            const oldestBtn = document.querySelector('[data-sort="date-asc"]');
            if (oldestBtn) oldestBtn.textContent = t.oldest;
            
            const titleBtn = document.querySelector('[data-sort="title"]');
            if (titleBtn) titleBtn.textContent = t.title;
            
            const allFilter = document.querySelector('[data-filter="all"]');
            if (allFilter) allFilter.textContent = t.allNotes;
            
            const pinnedFilter = document.querySelector('[data-filter="pinned"]');
            if (pinnedFilter) pinnedFilter.textContent = t.pinnedNotes;
            
            const normalFilter = document.querySelector('[data-filter="unpinned"]');
            if (normalFilter) normalFilter.textContent = t.normalNotes;
            
            // Update empty state
            const emptyState = document.getElementById('emptyState');
            emptyState.querySelector('h3').textContent = t.emptyStateTitle;
            emptyState.querySelector('p').textContent = t.emptyStateDesc;
            
            // Update privacy policy
            document.querySelector('.privacy-content h3').textContent = t.privacyTitle;
            document.querySelector('.privacy-text p:nth-child(1)').innerHTML = `<strong>${t.dataCollection}:</strong> ${t.dataCollectionText}`;
            document.querySelector('.privacy-text p:nth-child(2)').innerHTML = `<strong>${t.dataStorage}:</strong> ${t.dataStorageText}`;
            document.querySelector('.privacy-text p:nth-child(3)').innerHTML = `<strong>${t.cookies}:</strong> ${t.cookiesText}`;
            document.querySelector('.privacy-text p:nth-child(4)').innerHTML = `<strong>${t.thirdParty}:</strong> ${t.thirdPartyText}`;
            document.querySelector('.privacy-text p:nth-child(5)').innerHTML = `<strong>${t.security}:</strong> ${t.securityText}`;
            document.querySelector('.privacy-text p:nth-child(6)').innerHTML = `<strong>${t.contact}:</strong> ${t.contactText}`;
            document.querySelector('.privacy-links span').textContent = t.copyright;
        }
        
        // Translate to Turkish
        function translateToTurkish() {
            const t = translations.tr;
            
            // Update main elements
            document.querySelector('.app-title').innerHTML = `<i class="fas fa-sticky-note"></i> ${t.appTitle}`;
            document.querySelector('.settings-label').textContent = t.themeLabel;
            document.getElementById('noteTitle').placeholder = t.noteTitlePlaceholder;
            document.getElementById('noteContent').setAttribute('data-placeholder', t.noteContentPlaceholder);
            document.getElementById('addNote').innerHTML = `<i class="fas fa-plus"></i> ${t.addNote}`;
            document.getElementById('clearForm').innerHTML = `<i class="fas fa-eraser"></i> ${t.clearForm}`;
            document.getElementById('exportPDF').innerHTML = `<i class="fas fa-file-pdf"></i> ${t.exportPDF}`;
            document.getElementById('searchInput').placeholder = t.searchPlaceholder;
            
            // Update toolbar buttons
            document.querySelector('[data-command="bold"]').title = t.toolbarBold;
            document.querySelector('[data-command="italic"]').title = t.toolbarItalic;
            document.querySelector('[data-command="underline"]').title = t.toolbarUnderline;
            document.querySelector('[data-command="strikeThrough"]').title = t.toolbarStrike;
            document.querySelector('[data-command="insertUnorderedList"]').title = t.toolbarList;
            document.querySelector('[data-command="insertOrderedList"]').title = t.toolbarOrderedList;
            document.querySelector('[data-command="justifyLeft"]').title = t.toolbarLeft;
            document.querySelector('[data-command="justifyCenter"]').title = t.toolbarCenter;
            document.querySelector('[data-command="justifyRight"]').title = t.toolbarRight;
            document.getElementById('addImageBtn').title = t.toolbarImage;
            document.getElementById('textColorBtn').title = t.toolbarTextColor;
            
            // Update controls
            const sortSpan = document.querySelector('.sort-controls span');
            if (sortSpan) sortSpan.textContent = t.sortLabel;
            
            const newestBtn = document.querySelector('[data-sort="date-desc"]');
            if (newestBtn) newestBtn.textContent = t.newest;
            
            const oldestBtn = document.querySelector('[data-sort="date-asc"]');
            if (oldestBtn) oldestBtn.textContent = t.oldest;
            
            const titleBtn = document.querySelector('[data-sort="title"]');
            if (titleBtn) titleBtn.textContent = t.title;
            
            const allFilter = document.querySelector('[data-filter="all"]');
            if (allFilter) allFilter.textContent = t.allNotes;
            
            const pinnedFilter = document.querySelector('[data-filter="pinned"]');
            if (pinnedFilter) pinnedFilter.textContent = t.pinnedNotes;
            
            const normalFilter = document.querySelector('[data-filter="unpinned"]');
            if (normalFilter) normalFilter.textContent = t.normalNotes;
            
            // Update empty state
            const emptyState = document.getElementById('emptyState');
            emptyState.querySelector('h3').textContent = t.emptyStateTitle;
            emptyState.querySelector('p').textContent = t.emptyStateDesc;
            
            // Update privacy policy
            document.querySelector('#privacyTitle').textContent = t.privacyTitle;
            document.querySelector('#dataCollectionLabel').textContent = t.dataCollection + ':';
            document.querySelector('#dataCollectionText').textContent = t.dataCollectionText;
            document.querySelector('#dataStorageLabel').textContent = t.dataStorage + ':';
            document.querySelector('#dataStorageText').textContent = t.dataStorageText;
            document.querySelector('#cookiesLabel').textContent = t.cookies + ':';
            document.querySelector('#cookiesText').textContent = t.cookiesText;
            document.querySelector('#thirdPartyLabel').textContent = t.thirdParty + ':';
            document.querySelector('#thirdPartyText').textContent = t.thirdPartyText;
            document.querySelector('#securityLabel').textContent = t.security + ':';
            document.querySelector('#securityText').textContent = t.securityText;
            document.querySelector('#contactLabel').textContent = t.contact + ':';
            document.querySelector('#contactText').textContent = t.contactText;
            document.querySelector('#copyrightText').textContent = t.copyright;
            
            // Update MIT License
            const mitLicenseElement = document.querySelector('#mitLicenseText');
            mitLicenseElement.innerHTML = `<strong>${t.mitLicense}</strong> ${t.mitLicenseText} <a href="https://github.com/mutlukurt/Note-taking-app" target="_blank" rel="noopener">${t.githubRepo}</a>${t.visitText}`;
        }
    </script>
    
    <script>
        // Global functions for settings panel
        function toggleSettings() {
            console.log('toggleSettings called');
            const settingsToggle = document.getElementById('settingsToggle');
            const settingsPanel = document.getElementById('settingsPanel');
            
            if (settingsToggle && settingsPanel) {
                settingsToggle.classList.toggle('active');
                settingsPanel.classList.toggle('active');
                console.log('Settings panel toggled');
            } else {
                console.error('Settings elements not found');
            }
        }

        function toggleLanguage() {
            console.log('toggleLanguage called');
            const languageToggle = document.getElementById('languageToggle');
            const langText = languageToggle.querySelector('.lang-text');
            
            if (languageToggle && langText) {
                let newLang = 'tr';
                if (langText.textContent === 'TR') {
                    langText.textContent = 'EN';
                    languageToggle.classList.add('english');
                    newLang = 'en';
                    alert('Dil İngilizce olarak değiştirildi');
                } else {
                    langText.textContent = 'TR';
                    languageToggle.classList.remove('english');
                    newLang = 'tr';
                    alert('Dil Türkçe olarak değiştirildi');
                }
                
                // Apply translations to the page
                applyTranslations(newLang);
            }
        }

        function applyTranslations(lang) {
            const t = translations[lang];
            
            // Update main elements
            document.querySelector('.app-title').innerHTML = `<i class="fas fa-sticky-note"></i> ${t.appTitle}`;
            document.querySelector('.settings-label').textContent = t.language;
            document.getElementById('noteTitle').placeholder = t.noteTitlePlaceholder;
            document.getElementById('noteContent').setAttribute('data-placeholder', t.noteContentPlaceholder);
            document.getElementById('addNote').innerHTML = `<i class="fas fa-plus"></i> ${t.addNote}`;
            document.getElementById('clearForm').innerHTML = `<i class="fas fa-eraser"></i> ${t.clearForm}`;
            document.getElementById('exportPDF').innerHTML = `<i class="fas fa-file-pdf"></i> ${t.exportPDF}`;
            document.getElementById('searchInput').placeholder = t.searchPlaceholder;
            
            // Update toolbar buttons
            document.querySelector('[data-command="bold"]').title = t.toolbarBold;
            document.querySelector('[data-command="italic"]').title = t.toolbarItalic;
            document.querySelector('[data-command="underline"]').title = t.toolbarUnderline;
            document.querySelector('[data-command="strikeThrough"]').title = t.toolbarStrike;
            document.querySelector('[data-command="insertUnorderedList"]').title = t.toolbarList;
            document.querySelector('[data-command="insertOrderedList"]').title = t.toolbarOrderedList;
            document.querySelector('[data-command="justifyLeft"]').title = t.toolbarLeft;
            document.querySelector('[data-command="justifyCenter"]').title = t.toolbarCenter;
            document.querySelector('[data-command="justifyRight"]').title = t.toolbarRight;
            document.getElementById('addImageBtn').title = t.toolbarImage;
            document.getElementById('textColorBtn').title = t.toolbarTextColor;
            
            // Update controls
            const sortSpan = document.querySelector('.sort-controls span');
            if (sortSpan) sortSpan.textContent = t.sortLabel;
            
            const newestBtn = document.querySelector('[data-sort="date-desc"]');
            if (newestBtn) newestBtn.textContent = t.newest;
            
            const oldestBtn = document.querySelector('[data-sort="date-asc"]');
            if (oldestBtn) oldestBtn.textContent = t.oldest;
            
            const titleBtn = document.querySelector('[data-sort="title"]');
            if (titleBtn) titleBtn.textContent = t.title;
            
            const allFilter = document.querySelector('[data-filter="all"]');
            if (allFilter) allFilter.textContent = t.allNotes;
            
            const pinnedFilter = document.querySelector('[data-filter="pinned"]');
            if (pinnedFilter) pinnedFilter.textContent = t.pinnedNotes;
            
            const normalFilter = document.querySelector('[data-filter="unpinned"]');
            if (normalFilter) normalFilter.textContent = t.normalNotes;
            
            // Update empty state
            const emptyState = document.getElementById('emptyState');
            if (emptyState) {
                emptyState.querySelector('h3').textContent = t.emptyStateTitle;
                emptyState.querySelector('p').textContent = t.emptyStateDesc;
            }
            
            // Update privacy policy
            document.querySelector('#privacyTitle').textContent = t.privacyTitle;
            document.querySelector('#dataCollectionLabel').textContent = t.dataCollection + ':';
            document.querySelector('#dataCollectionText').textContent = t.dataCollectionText;
            document.querySelector('#dataStorageLabel').textContent = t.dataStorage + ':';
            document.querySelector('#dataStorageText').textContent = t.dataStorageText;
            document.querySelector('#cookiesLabel').textContent = t.cookies + ':';
            document.querySelector('#cookiesText').textContent = t.cookiesText;
            document.querySelector('#thirdPartyLabel').textContent = t.thirdParty + ':';
            document.querySelector('#thirdPartyText').textContent = t.thirdPartyText;
            document.querySelector('#securityLabel').textContent = t.security + ':';
            document.querySelector('#securityText').textContent = t.securityText;
            document.querySelector('#contactLabel').textContent = t.contact + ':';
            document.querySelector('#contactText').textContent = t.contactText;
            document.querySelector('#copyrightText').textContent = t.copyright;
            
            // Update MIT License
            const mitLicenseElement = document.querySelector('#mitLicenseText');
            mitLicenseElement.innerHTML = `<strong>${t.mitLicense}</strong> ${t.mitLicenseText} <a href="https://github.com/mutlukurt/Note-taking-app" target="_blank" rel="noopener">${t.githubRepo}</a>${t.visitText}`;
        }

        // Mobile touch support
        document.addEventListener('DOMContentLoaded', function() {
            // Touch events for mobile
            const settingsToggle = document.getElementById('settingsToggle');
            const languageToggle = document.getElementById('languageToggle');
            
            if (settingsToggle) {
                settingsToggle.addEventListener('touchstart', function(e) {
                    e.preventDefault();
                    toggleSettings();
                });
            }
            
            if (languageToggle) {
                languageToggle.addEventListener('touchstart', function(e) {
                    e.preventDefault();
                    toggleLanguage();
                });
            }
        });
    </script>
    
    <script src="script.js"></script>
    
    <!-- Gizlilik Politikası ve Lisans -->
    <footer class="privacy-policy">
        <div class="container">
            <div class="privacy-content">
                <h3 id="privacyTitle">🔒 Gizlilik Politikası</h3>
                <div class="privacy-text">
                    <p id="dataCollectionSection"><strong id="dataCollectionLabel">Veri Toplama:</strong> <span id="dataCollectionText">Bu uygulama hiçbir kişisel veri toplamaz. Tüm notlarınız sadece tarayıcınızda saklanır.</span></p>
                    <p id="dataStorageSection"><strong id="dataStorageLabel">Veri Saklama:</strong> <span id="dataStorageText">Notlarınız LocalStorage kullanılarak yerel olarak saklanır. Hiçbir veri sunucuya gönderilmez.</span></p>
                    <p id="cookiesSection"><strong id="cookiesLabel">Çerezler:</strong> <span id="cookiesText">Uygulama sadece tema ve dil tercihlerinizi saklamak için gerekli çerezleri kullanır.</span></p>
                    <p id="thirdPartySection"><strong id="thirdPartyLabel">Üçüncü Taraf:</strong> <span id="thirdPartyText">Font Awesome ikonları ve PDF kütüphaneleri için CDN kullanılır. Bu servisler sadece uygulama işlevselliği için gereklidir.</span></p>
                    <p id="securitySection"><strong id="securityLabel">Güvenlik:</strong> <span id="securityText">Tüm verileriniz tarayıcınızda güvenli şekilde saklanır ve şifrelenir.</span></p>
                    <p id="contactSection"><strong id="contactLabel">İletişim:</strong> <span id="contactText">Sorularınız için GitHub üzerinden iletişime geçebilirsiniz.</span></p>
                </div>
                <div class="privacy-links">
                    <span id="copyrightText">© 2025 Not Alma Uygulaması | MIT License</span>
                    <div class="license-info">
                        <p id="mitLicenseText">
                            <strong>MIT Lisansı:</strong> Bu proje açık kaynak kodludur. Kaynak kodu serbestçe kullanabilir, değiştirebilir ve dağıtabilirsiniz. 
                            Detaylar için <a href="https://github.com/mutlukurt/Note-taking-app" target="_blank" rel="noopener">GitHub deposunu</a> ziyaret edin.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </footer>
</body>
</html>